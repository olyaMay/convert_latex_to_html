<head>
  <title>Математические структуры и моделирование</title>
  <link href="style.css" rel="stylesheet">
</head><body>
  <div class="wrapper">
    <div class="header">
      <div class="numbers_left">
        <span>Математические структуры и моделирование 2019. №1(49).</span>
      </div>
      <div class="numbers_right">
        <span>УДК     004.7:004.056</span>
      </div>
    </div>
    <div class="title">
      <span>Программа, имитирующая сетевые атаки на компьютеры</span>
    </div>
    <div class="authors">
      <div class="author">
        <span>А.К. Гуц,</span>
      </div>
      <div class="contact">
        <span>д.ф.-м.н., профессор,</span>
        <span>e-mail:  aguts@mail.ru</span>
      </div>
      <div class="author">
        <span>О.В. Матюшина</span>
      </div>
      <div class="contact">
        <span>студент,</span>
        <span>e-mail:  vladimirova.o94@gmail.com</span>
      </div>
    </div>
    <div class="omsu">
      <span>Омский государственный университет им. Ф.М. Достоевского, Омск, Россия</span>
    </div>
    <div class="article__info">
      <div class="annotation">
        <span class="bold">Аннотация. </span>
        <span>Цель статьи - представить программу, которая  моделирует работу  компьютерной сети, а также демонстрирует 
результаты использования недобросовестным пользователем некоторых сетевых уязвимостей.</span>
      </div>
      <div class="annotation">
        <span class="bold">Ключевые слова: </span>
        <span>компьютерная сеть, сетевые атаки, сетевые уязвимости, имитация сетевых атак</span>
      </div>
    </div>
    <div class="article__title">
      <span>Введение</span>
    </div>
    <div class="article__text">
      <span> При обучении студентов по направлению &quot;Информационная безопасность&quot;, осваивающих средства защиты от сетевых атак, полезно иметь программное приложение, имитирующее сетевые атаки типа  Smurfing, SYN-Flood, подмена MAC-адрес, ARP-spoofing  и другие.</span>
    </div>
    <div class="article__text">
      <span>Такие программы уже создавались в ОмГУ \cite{gum1,gum2}, но каждая из них, к сожалению, имеет свои недостатки, хотя и решает поставленные задачи.</span>
    </div>
    <div class="article__text">
      <span>  В статье представлена новая компьютерная программа, имитирующая сетевые атаки.</span>
    </div>
    <div class="article__text">
      <span> В ходе работы программы открываются окна, представляющие компьютер злоумышленника и компьютеры, входящие в состав атакуемой сети.</span>
    </div>
    <div class="article__title">
      <span>Описание окон программы и их возможностей</span>
    </div>
    <div class="article__text">
      <span> Для разработки использовался язык</span>
    </div>
    <div class="article__text">
      <span>программирования $C\sharp$.</span>
    </div>
    <div class="article__text">
      <span>Чтобы реализовать возможность передачи сообщений между окнами</span>
    </div>
    <div class="article__text">
      <span>программы, было решено использовать несколько встроенных классов:</span>
    </div>
    <div class="article__text">
      <span>обеспечивающих клиентские подключения для сетевых служб,</span>
    </div>
    <div class="article__text">
      <span>работающих с потоками и потоками данных.</span>
    </div>
    <div class="article__text">
      <span>В функции отправки создаётся экземпляр класса &quot;TcpClient&quot;,</span>
    </div>
    <div class="article__text">
      <span>сообщение переводится из строкового типа в байтовый массив,</span>
    </div>
    <div class="article__text">
      <span>который уже с помощью открывшегося потока передачи данных</span>
    </div>
    <div class="article__text">
      <span>посылается на указанный порт. Затем поток закрывается, а экземпляр</span>
    </div>
    <div class="article__text">
      <span>класса удаляется:</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>  //создание нового TCP клиента</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>TcpClient client = new TcpClient(&quot;localhost&quot;,</span>
    </div>
    <div class="article__text">
      <span>Convert.ToInt32(port));</span>
    </div>
    <div class="article__text">
      <span>byte[] data = new byte[256];</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>      //перевод строки в байтовый массив</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>byte[] msg = Encoding.UTF8.GetBytes(str);</span>
    </div>
    <div class="article__text">
      <span>int count = msg.Length \lt= 256 ? msg.Length : 256;</span>
    </div>
    <div class="article__text">
      <span>Array.Copy(msg, data, count);</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>  //создание потока передачи данных</span>
    </div>
    <div class="article__text">
      <span>NetworkStream stream = client.GetStream();</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>  //запись строки в поток</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>stream.Write(data, 0, 256);</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>      //закрытие потока и удаление TCP клиента</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>stream.Close();</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>client.Close();</span>
    </div>
    <div class="article__text">
      <span>textBox3.Text += &quot;Отправлено &quot; + oppPort + &quot; &quot;\gt &quot; + str;</span>
    </div>
    <div class="article__text">
      <span>textBox3.Text += Environment.NewLine;</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>}</span>
    </div>
    <div class="article__text">
      <span> Приём сообщения осуществляется сложнее. Здесь уже вступают в</span>
    </div>
    <div class="article__text">
      <span>роль потоки. Чтобы прослушивать заданный порт беспрерывно, а не по</span>
    </div>
    <div class="article__text">
      <span>нажатию кнопки, создаётся отдельный поток, который этим</span>
    </div>
    <div class="article__text">
      <span>занимается, периодически &quot;засыпая&quot;, чтобы постоянно</span>
    </div>
    <div class="article__text">
      <span> не грузить</span>
    </div>
    <div class="article__text">
      <span>систему. На каждый прослушиваемый порт создаётся свой поток,</span>
    </div>
    <div class="article__text">
      <span>благодаря чему можно принимать сообщение одновременно</span>
    </div>
    <div class="article__text">
      <span>с них всех.</span>
    </div>
    <div class="article__text">
      <span>Если в поток приёма данных попадает байтовый массив,</span>
    </div>
    <div class="article__text">
      <span>переданный с</span>
    </div>
    <div class="article__text">
      <span>другого окна, то этот массив переводится в строковую</span>
    </div>
    <div class="article__text">
      <span>переменную.</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span> Окна злоумышленника и компьютеров}. На окна злоумышленника и</span>
    </div>
    <div class="article__text">
      <span>компьютеров была добавлена возможность отправить сообщение на</span>
    </div>
    <div class="article__text">
      <span>выбранный адрес. При этом, если отправитель не знает входящий порт</span>
    </div>
    <div class="article__text">
      <span>адресата (имитация MAC-адреса),</span>
    </div>
    <div class="article__text">
      <span> то будет</span>
    </div>
    <div class="article__text">
      <span>послан широковещательный пакет ARP-Request.</span>
    </div>
    <div class="article__text">
      <span>Также</span>
    </div>
    <div class="article__text">
      <span> был добавлен</span>
    </div>
    <div class="article__text">
      <span>обработчик, проверяющий, что за сообщение нам пришло, и либо</span>
    </div>
    <div class="article__text">
      <span>отбрасывающий его, либо инициализирующий какие-то определённые</span>
    </div>
    <div class="article__text">
      <span>действия. Например, если пришёл ARP-Request - отправить в ответ</span>
    </div>
    <div class="article__text">
      <span>ARP-Reply:</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>   //Если ARP-Request</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>if (instr.Substring(13, 1) == &quot;1&quot;)</span>
    </div>
    <div class="article__text">
      <span>{</span>
    </div>
    <div class="article__text">
      <span>textBox.Text += &quot;&quot;\ltARP REQUEST от &quot; + instr.Substring(10, 3);</span>
    </div>
    <div class="article__text">
      <span>          textBox.Text += Environment.NewLine;</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>  //Обычное + Mac-адрес назначения + наш Mac-адрес +</span>
    </div>
    <div class="article__text">
      <span>адрес назначения + наш адрес + ARP-Reply</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>str += &quot;0&quot; + instr.Substring(4, 3) + localPort +</span>
    </div>
    <div class="article__text">
      <span>instr.Substring(10, 3) +    adres + &quot;2&quot;;</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>          Thread.Sleep(1000);</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>          //Отправка</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>          Send(str);</span>
    </div>
    <div class="article__text">
      <span>          return;</span>
    </div>
    <div class="article__text">
      <span>}</span>
    </div>
    <div class="article__text">
      <span>}</span>
    </div>
    <div class="article__text">
      <span> Окно сервера}. Это окно принимает не ARP--сообщения только</span>
    </div>
    <div class="article__text">
      <span>после процедуры &quot;тройного рукопожатия&quot;. После получения пакета</span>
    </div>
    <div class="article__text">
      <span>SYN сервер записывает исходящий MAC-адрес из пакета в буфер и</span>
    </div>
    <div class="article__text">
      <span>отправляет ответ SYN-ACK. Если затем придёт пакет ACK от той же</span>
    </div>
    <div class="article__text">
      <span>машины, то сервер &quot;запомнит&quot; подключение и уберёт</span>
    </div>
    <div class="article__text">
      <span>соответствующую запись из буфера. Чистку буфера через некоторое</span>
    </div>
    <div class="article__text">
      <span>время, как на настоящем оборудовании, решено не добавлять, так как</span>
    </div>
    <div class="article__text">
      <span>программа работает значительно медленнее реальных сетей и для</span>
    </div>
    <div class="article__text">
      <span>демонстрации это не понадобится.</span>
    </div>
    <div class="article__text">
      <span>Был принят в работу способ конфигурирования сети посредством</span>
    </div>
    <div class="article__text">
      <span>кнопок &quot;Добавить...&quot;.</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>  Окно коммутатора}. Принимая на один из портов пакет,</span>
    </div>
    <div class="article__text">
      <span>коммутатор сначала проверяет MAC-адрес отправителя и ищет его в</span>
    </div>
    <div class="article__text">
      <span>своей таблице MAC-адресов. Если не находит, то делает в ней</span>
    </div>
    <div class="article__text">
      <span>запись, что этот MAC доступен по порту, с которого пришло</span>
    </div>
    <div class="article__text">
      <span>сообщение. Затем проверяется MAC-адрес назначения и также ищется</span>
    </div>
    <div class="article__text">
      <span>в таблице. Если находит, пакет посылается на нужный порт, если нет</span>
    </div>
    <div class="article__text">
      <span>- происходит широковещательная рассылка.</span>
    </div>
    <div class="article__text">
      <span>Для того чтобы программа нормально функционировала, на все</span>
    </div>
    <div class="article__text">
      <span>&quot;устройства&quot; добавлены переменные или их массивы (в зависимости</span>
    </div>
    <div class="article__text">
      <span>от типа), хранящие информацию о том, какие &quot;соседские&quot; порты подключены</span>
    </div>
    <div class="article__text">
      <span>к каким локальным портам (имитация соединения проводом). Иначе</span>
    </div>
    <div class="article__text">
      <span>окна знали бы только на какой порт пришёл пакет, но не с какого на</span>
    </div>
    <div class="article__text">
      <span>соседнем &quot;устройстве&quot;.</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span> Окно маршрутизатора}. Его отличает от коммутатора то,</span>
    </div>
    <div class="article__text">
      <span> что он</span>
    </div>
    <div class="article__text">
      <span>работает с обычными адресами, а не с MAC. А также то, что</span>
    </div>
    <div class="article__text">
      <span>маршрутизаторы обмениваются между собой таблицами</span>
    </div>
    <div class="article__text">
      <span>маршрутизации. В</span>
    </div>
    <div class="article__text">
      <span>программе это происходит при изменении топологии сети,</span>
    </div>
    <div class="article__text">
      <span>инициализированном с одного из них.</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span> Во все окна (кроме коммутатора) добавлена возможность</span>
    </div>
    <div class="article__text">
      <span>назначить адрес, а в компьютеры и злоумышленника - ещё</span>
    </div>
    <div class="article__text">
      <span>возможность назначить шлюз. Это сделано для имитации локальной</span>
    </div>
    <div class="article__text">
      <span>(доменной)</span>
    </div>
    <div class="article__text">
      <span> сети</span>
    </div>
    <div class="article__text">
      <span>и внешней (интернет). В окно злоумышленника добавлена также</span>
    </div>
    <div class="article__text">
      <span>возможность отправить пакет, собранный из отдельных &quot;кусочков&quot;,</span>
    </div>
    <div class="article__text">
      <span>каждый из которых задаётся в отдельности.</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span> Атаки были протестированы.</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span> </span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>Там, где в реальности для атаки необходимо большое количество</span>
    </div>
    <div class="article__text">
      <span>хостов, мы ограничимся двумя-тремя. Программа использует свою</span>
    </div>
    <div class="article__text">
      <span>структуру сетевого пакета в отличие от реальных сетей. Это</span>
    </div>
    <div class="article__text">
      <span>допущение позволяет увеличить наглядность и упростить</span>
    </div>
    <div class="article__text">
      <span>моделирование. При запуске программы открывается окно, выступающее</span>
    </div>
    <div class="article__text">
      <span>в роли компьютера взломщика (см. рис. 1).</span>
    </div>
    <div class="article__text">
      <span>\begin{figure}[h]\centering\includegraphics[width=8cm]{gumat1.eps\caption{\footnotesize Стартовое окно (оно же -- компьютер</span>
    </div>
    <div class="article__text">
      <span>злоумышленника) }</span>
    </div>
    <div class="article__text">
      <span>\end{figure}\label{gumat1}</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>Решение начинать с него обусловлено тем, что в сети такое будет</span>
    </div>
    <div class="article__text">
      <span>одно. В окне &quot;Злоумышленник&quot; имеется возможность отправить</span>
    </div>
    <div class="article__text">
      <span>произвольное сообщение на указанный адрес внутри моделируемой</span>
    </div>
    <div class="article__text">
      <span>сети, подключить новый маршрутизатор или коммутатор. Имеется поле,</span>
    </div>
    <div class="article__text">
      <span>куда будут выводиться полученные и служебные сообщения. Основное</span>
    </div>
    <div class="article__text">
      <span>отличие этого окна от других &quot;хостов&quot; - наличие кнопки</span>
    </div>
    <div class="article__text">
      <span>&quot;Отправить с параметрами&quot;, позволяющей, используя введённые</span>
    </div>
    <div class="article__text">
      <span>пользователем данные, передать сообщение с произвольными адресами</span>
    </div>
    <div class="article__text">
      <span>назначения и отправки, а также выбранного типа. Чтобы добавить в</span>
    </div>
    <div class="article__text">
      <span>сеть новое устройство (оно будет сразу подключено к компьютеру</span>
    </div>
    <div class="article__text">
      <span>&quot;проводом&quot;), надо в два поля ввести трёхзначные адреса, первый</span>
    </div>
    <div class="article__text">
      <span>- порта компьютера с которого идёт подключение, второй --</span>
    </div>
    <div class="article__text">
      <span>подключённого &quot;проводом&quot; порта второго устройства, затем нажать</span>
    </div>
    <div class="article__text">
      <span>&quot;Добавить маршрутизатор&quot; или &quot;Добавить коммутатор&quot;.</span>
    </div>
    <div class="article__text">
      <span> Функция</span>
    </div>
    <div class="article__text">
      <span>открытия нового окна &quot;Маршрутизатор&quot; с нужными параметрами:</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>string inPort = &quot;&quot;;</span>
    </div>
    <div class="article__text">
      <span>string outPort = &quot;&quot;;</span>
    </div>
    <div class="article__text">
      <span>if (inPortBox.Text.Length != 3 || outPortBox.Text.Length != 3)</span>
    </div>
    <div class="article__text">
      <span>            {</span>
    </div>
    <div class="article__text">
      <span>                MessageBox.Show(&quot;Порты должны состоять из трех цифр&quot;);</span>
    </div>
    <div class="article__text">
      <span>                return;</span>
    </div>
    <div class="article__text">
      <span>            }</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>       //порт в родительском окне</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>inPort = inPortBox.Text;</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>  //порт в подключаемом окне</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>outPort = outPortBox.Text;</span>
    </div>
    <div class="article__text">
      <span>  //открытие порта</span>
    </div>
    <div class="article__text">
      <span>Open(inPort);</span>
    </div>
    <div class="article__text">
      <span>oppPort = outPort;</span>
    </div>
    <div class="article__text">
      <span>localPort = &quot;&quot; + inPort;</span>
    </div>
    <div class="article__text">
      <span>this.Text += &quot; &quot; + inPort;</span>
    </div>
    <div class="article__text">
      <span>CreateRouter.Visible = false;</span>
    </div>
    <div class="article__text">
      <span>inPortBox.Visible = false;</span>
    </div>
    <div class="article__text">
      <span>outPortBox.Visible = false;</span>
    </div>
    <div class="article__text">
      <span>label2.Visible = false;</span>
    </div>
    <div class="article__text">
      <span>label3.Visible = false;</span>
    </div>
    <div class="article__text">
      <span>CreateSwitch.Visible = false;</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>  //добавление нового окна и передача ему номеров</span>
    </div>
    <div class="article__text">
      <span>портов</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>    //(имитация подключения проводом)</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>Form Form2 = new Router(outPort, inPort);</span>
    </div>
    <div class="article__text">
      <span>    Form2.Show();</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>}</span>
    </div>
    <div class="article__text">
      <span>В открывшемся окне (и в маршрутизаторе, и в коммутаторе)</span>
    </div>
    <div class="article__text">
      <span>появляется</span>
    </div>
    <div class="article__text">
      <span>новая возможность - добавить в сеть новый компьютер. Принцип её</span>
    </div>
    <div class="article__text">
      <span>действия аналогичен только что рассмотренному.</span>
    </div>
    <div class="article__text">
      <span>Машина, добавленная с её помощью, сразу соединится с родительским</span>
    </div>
    <div class="article__text">
      <span>устройством (с тем, с которого она была открыта), а также не будет</span>
    </div>
    <div class="article__text">
      <span>иметь возможность добавлять новые узлы в сеть, так как будет</span>
    </div>
    <div class="article__text">
      <span>являться по сути одной из конечных точек сети.</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span> </span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span> Для демонстрации взрывного увеличения сетевого</span>
    </div>
    <div class="article__text">
      <span>трафика в программу на компьютер злоумышленника добавлена</span>
    </div>
    <div class="article__text">
      <span>возможность отослать пакет ICMP ECHO REQUEST.</span>
    </div>
    <div class="article__text">
      <span>На компьютеры, в свою очередь, добавлена функция обработки этого</span>
    </div>
    <div class="article__text">
      <span>условного пакета и отправки в ответ ICMP ECHO REPLY.</span>
    </div>
    <div class="article__text">
      <span>При отправке с компьютера злоумышленника кнопкой &quot;Отправить с</span>
    </div>
    <div class="article__text">
      <span>параметрами&quot; можно</span>
    </div>
    <div class="article__text">
      <span> выбрать</span>
    </div>
    <div class="article__text">
      <span>данные как на рисунке (см. рис. 2), тогда после первой отправки</span>
    </div>
    <div class="article__text">
      <span>инициализируется ARP--знакомство хостов, а после второй уже пойдут</span>
    </div>
    <div class="article__text">
      <span>пакеты ICMP ECHO REPLY на машину жертвы (см. рис. 3).</span>
    </div>
    <div class="article__text">
      <span>Как видно, итог - количество сообщений на канале передачи данных</span>
    </div>
    <div class="article__text">
      <span>жертвы равно количеству хостов в сети</span>
    </div>
    <div class="article__text">
      <span>(не считая двух &quot;главных</span>
    </div>
    <div class="article__text">
      <span>героев&quot;) при всего лишь одном сообщении у злоумышленника.</span>
    </div>
    <div class="article__text">
      <span>\</span>
    </div>
    <div class="article__text">
      <span>\begin{figure}[h!]\centering\includegraphics[width=8cm]{gumat2.eps\caption{\footnotesize Отправка широковещательного запроса ECHO</span>
    </div>
    <div class="article__text">
      <span>REQUEST }\centering\includegraphics[width=8cm]{gumat3.eps\caption{\footnotesize Сообщения ECHO REPLY на машине жертвы }</span>
    </div>
    <div class="article__text">
      <span>\end{figure}\label{gumat3}</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>\</span>
    </div>
    <div class="article__text">
      <span>\begin{figure}[h]\centering\includegraphics[width=8cm]{gumat4.eps\caption{\footnotesize Ответ SYN-ACK от сервера }</span>
    </div>
    <div class="article__text">
      <span>\end{figure}\label{gumat4}</span>
    </div>
    <div class="article__text">
      <span>Цикл широковещательной отправки:</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>  //отправка по всем каналам, кроме того, откуда</span>
    </div>
    <div class="article__text">
      <span>пришло</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>for (int i = 0;</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>i \lt llen; i++)</span>
    </div>
    <div class="article__text">
      <span>{</span>
    </div>
    <div class="article__text">
      <span>if (localPorts[i] != port)</span>
    </div>
    <div class="article__text">
      <span>            {</span>
    </div>
    <div class="article__text">
      <span>    Thread.Sleep(200);</span>
    </div>
    <div class="article__text">
      <span>          Send(outPorts[i], str);</span>
    </div>
    <div class="article__text">
      <span>            }</span>
    </div>
    <div class="article__text">
      <span>}</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>}</span>
    </div>
    <div class="article__text">
      <span> </span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span> Для начала демонстрации существенных задержек</span>
    </div>
    <div class="article__text">
      <span>при установке связи нужно добавить в сеть сервер. Его отличие от</span>
    </div>
    <div class="article__text">
      <span>компьютера в том, что он не принимает входящие сообщения, пока не</span>
    </div>
    <div class="article__text">
      <span>будет установлено соединение процессом &quot;тройного рукопожатия&quot;.</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>В обычной ситуации сервер отвечает пакетом SYN-ACK на все новые</span>
    </div>
    <div class="article__text">
      <span>подключения (см. рис. 4). Но если злоумышленник начнёт непрерывно</span>
    </div>
    <div class="article__text">
      <span>посылать с чужих адресов пакеты SYN на сервер, последний будет</span>
    </div>
    <div class="article__text">
      <span>добавлять эти запросы в очередь. А поскольку злоумышленник</span>
    </div>
    <div class="article__text">
      <span>отвечать на SYN-ACK сервера не будет, очередь переполнится, и не</span>
    </div>
    <div class="article__text">
      <span>останется места новым подключениям.</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>Даже при условии чистки очереди через некоторое время (тайм-аут</span>
    </div>
    <div class="article__text">
      <span>подключений) задержки будут серьезными.</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>\begin{figure}[h!]\centering\includegraphics[width=8cm]{gumat5.eps\caption{\footnotesize Отправка поддельного ARP-Reply }</span>
    </div>
    <div class="article__text">
      <span>\end{figure}\label{gumat5}</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span> </span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span> Чтобы продемонстрировать возможности</span>
    </div>
    <div class="article__text">
      <span>изменения МАС-адреса в ARP-таблице, для начала отправим сообщение</span>
    </div>
    <div class="article__text">
      <span>&quot;Первый привет&quot; с машины жертвы с внешним адресом назначения (в</span>
    </div>
    <div class="article__text">
      <span>программе это 100 и больше) на заранее созданный компьютер,</span>
    </div>
    <div class="article__text">
      <span>находящийся &quot;за&quot; маршрутизатором и имитирующий интернет.</span>
    </div>
    <div class="article__text">
      <span>Послание дойдёт до адресата. Затем отправим от злоумышленника</span>
    </div>
    <div class="article__text">
      <span>ARP-Reply с нужными параметрами (см. рис. 5), чтобы машина жертвы,</span>
    </div>
    <div class="article__text">
      <span>сопоставив IP из пакета с IP роутера, заменила его МАС-адрес на</span>
    </div>
    <div class="article__text">
      <span>новый. После этого попытка снова отправить сообщение &quot;Второй</span>
    </div>
    <div class="article__text">
      <span>привет&quot; (см. рис. 6) не увенчается успехом (см. рис. 7). Теперь</span>
    </div>
    <div class="article__text">
      <span>жертва отрезана от интернета.</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>\begin{figure}[h]\centering\includegraphics[width=8cm]{gumat6.eps\caption{\footnotesize Отправка двух сообщений }\centering\includegraphics[width=8cm]{gumat7.eps\caption{\footnotesize Получение первого сообщения }</span>
    </div>
    <div class="article__text">
      <span>\end{figure}\label{gumat7}</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span> </span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span> Демонстрация возможности перехвата</span>
    </div>
    <div class="article__text">
      <span>сетевого трафика.</span>
    </div>
    <div class="article__text">
      <span>Злоумышленник посылает поддельный пакет ARP--Reply роутеру,</span>
    </div>
    <div class="article__text">
      <span>который, сопоставив IP из пакета с IP жертвы, заменяет её</span>
    </div>
    <div class="article__text">
      <span>МАС-адрес на МАС-адрес злоумышленника.</span>
    </div>
    <div class="article__text">
      <span> Затем посылается поддельный</span>
    </div>
    <div class="article__text">
      <span>пакет ARP--Reply жертве, которая, сопоставив IP из пакета с IP</span>
    </div>
    <div class="article__text">
      <span>роутера, заменяет его МАС-адрес на МАС-адрес злоумышленника.</span>
    </div>
    <div class="article__text">
      <span>Теперь злоумышленник может просматривать исходящий сетевой трафик</span>
    </div>
    <div class="article__text">
      <span>жертвы.</span>
    </div>
    <div class="article__text">
      <span>Данная атака весьма похожа на подмену MAC-адреса, отличие в том,</span>
    </div>
    <div class="article__text">
      <span>что второе сообщение всё-таки доходит до компьютера-адресата (см.</span>
    </div>
    <div class="article__text">
      <span>рис. 8), но не напрямую, а предварительно пройдя через машину</span>
    </div>
    <div class="article__text">
      <span>злоумышленника (см. рис. 9).</span>
    </div>
    <div class="article__text">
      <span>\begin{figure}[h!]\centering\includegraphics[width=8cm]{gumat8.eps\caption{\footnotesize Получение обоих сообщений}\centering\includegraphics[width=8cm]{gumat9.eps\caption{\footnotesize  Получение сообщения злоумышленником }</span>
    </div>
    <div class="article__text">
      <span>\end{figure}\label{gumat9}</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span> </span>
    </div>
    <div class="article__title">
      <span>Основная структура</span>
    </div>
    <div class="article__text">
      <span> Для разработки использовался язык</span>
    </div>
    <div class="article__text">
      <span>программирования $C\sharp$.</span>
    </div>
    <div class="article__text">
      <span>Чтобы реализовать возможность передачи сообщений между окнами</span>
    </div>
    <div class="article__text">
      <span>программы, было решено использовать несколько встроенных классов:</span>
    </div>
    <div class="article__text">
      <span>обеспечивающих клиентские подключения для сетевых служб,</span>
    </div>
    <div class="article__text">
      <span>работающих с потоками и потоками данных.</span>
    </div>
    <div class="article__text">
      <span>В функции отправки создаётся экземпляр класса &quot;TcpClient&quot;,</span>
    </div>
    <div class="article__text">
      <span>сообщение переводится из строкового типа в байтовый массив,</span>
    </div>
    <div class="article__text">
      <span>который уже с помощью открывшегося потока передачи данных</span>
    </div>
    <div class="article__text">
      <span>посылается на указанный порт. Затем поток закрывается, а экземпляр</span>
    </div>
    <div class="article__text">
      <span>класса удаляется:</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>  //создание нового TCP клиента</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>TcpClient client = new TcpClient(&quot;localhost&quot;,</span>
    </div>
    <div class="article__text">
      <span>Convert.ToInt32(port));</span>
    </div>
    <div class="article__text">
      <span>byte[] data = new byte[256];</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>      //перевод строки в байтовый массив</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>byte[] msg = Encoding.UTF8.GetBytes(str);</span>
    </div>
    <div class="article__text">
      <span>int count = msg.Length \lt= 256 ? msg.Length : 256;</span>
    </div>
    <div class="article__text">
      <span>Array.Copy(msg, data, count);</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>  //создание потока передачи данных</span>
    </div>
    <div class="article__text">
      <span>NetworkStream stream = client.GetStream();</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>  //запись строки в поток</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>stream.Write(data, 0, 256);</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>      //закрытие потока и удаление TCP клиента</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>stream.Close();</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>client.Close();</span>
    </div>
    <div class="article__text">
      <span>textBox3.Text += &quot;Отправлено &quot; + oppPort + &quot; &quot;\gt &quot; + str;</span>
    </div>
    <div class="article__text">
      <span>textBox3.Text += Environment.NewLine;</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>}</span>
    </div>
    <div class="article__text">
      <span> Приём сообщения осуществляется сложнее. Здесь уже вступают в</span>
    </div>
    <div class="article__text">
      <span>роль потоки. Чтобы прослушивать заданный порт беспрерывно, а не по</span>
    </div>
    <div class="article__text">
      <span>нажатию кнопки, создаётся отдельный поток, который этим</span>
    </div>
    <div class="article__text">
      <span>занимается, периодически &quot;засыпая&quot;, чтобы постоянно</span>
    </div>
    <div class="article__text">
      <span> не грузить</span>
    </div>
    <div class="article__text">
      <span>систему. На каждый прослушиваемый порт создаётся свой поток,</span>
    </div>
    <div class="article__text">
      <span>благодаря чему можно принимать сообщение одновременно</span>
    </div>
    <div class="article__text">
      <span>с них всех.</span>
    </div>
    <div class="article__text">
      <span>Если в поток приёма данных попадает байтовый массив,</span>
    </div>
    <div class="article__text">
      <span>переданный с</span>
    </div>
    <div class="article__text">
      <span>другого окна, то этот массив переводится в строковую</span>
    </div>
    <div class="article__text">
      <span>переменную.</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span> Окна злоумышленника и компьютеров}. На окна злоумышленника и</span>
    </div>
    <div class="article__text">
      <span>компьютеров была добавлена возможность отправить сообщение на</span>
    </div>
    <div class="article__text">
      <span>выбранный адрес. При этом, если отправитель не знает входящий порт</span>
    </div>
    <div class="article__text">
      <span>адресата (имитация MAC-адреса),</span>
    </div>
    <div class="article__text">
      <span> то будет</span>
    </div>
    <div class="article__text">
      <span>послан широковещательный пакет ARP-Request.</span>
    </div>
    <div class="article__text">
      <span>Также</span>
    </div>
    <div class="article__text">
      <span> был добавлен</span>
    </div>
    <div class="article__text">
      <span>обработчик, проверяющий, что за сообщение нам пришло, и либо</span>
    </div>
    <div class="article__text">
      <span>отбрасывающий его, либо инициализирующий какие-то определённые</span>
    </div>
    <div class="article__text">
      <span>действия. Например, если пришёл ARP-Request - отправить в ответ</span>
    </div>
    <div class="article__text">
      <span>ARP-Reply:</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>   //Если ARP-Request</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>if (instr.Substring(13, 1) == &quot;1&quot;)</span>
    </div>
    <div class="article__text">
      <span>{</span>
    </div>
    <div class="article__text">
      <span>textBox.Text += &quot;&quot;\ltARP REQUEST от &quot; + instr.Substring(10, 3);</span>
    </div>
    <div class="article__text">
      <span>          textBox.Text += Environment.NewLine;</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>  //Обычное + Mac-адрес назначения + наш Mac-адрес +</span>
    </div>
    <div class="article__text">
      <span>адрес назначения + наш адрес + ARP-Reply</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>str += &quot;0&quot; + instr.Substring(4, 3) + localPort +</span>
    </div>
    <div class="article__text">
      <span>instr.Substring(10, 3) +    adres + &quot;2&quot;;</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>          Thread.Sleep(1000);</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>          //Отправка</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>          Send(str);</span>
    </div>
    <div class="article__text">
      <span>          return;</span>
    </div>
    <div class="article__text">
      <span>}</span>
    </div>
    <div class="article__text">
      <span>}</span>
    </div>
    <div class="article__text">
      <span> Окно сервера}. Это окно принимает не ARP--сообщения только</span>
    </div>
    <div class="article__text">
      <span>после процедуры &quot;тройного рукопожатия&quot;. После получения пакета</span>
    </div>
    <div class="article__text">
      <span>SYN сервер записывает исходящий MAC-адрес из пакета в буфер и</span>
    </div>
    <div class="article__text">
      <span>отправляет ответ SYN-ACK. Если затем придёт пакет ACK от той же</span>
    </div>
    <div class="article__text">
      <span>машины, то сервер &quot;запомнит&quot; подключение и уберёт</span>
    </div>
    <div class="article__text">
      <span>соответствующую запись из буфера. Чистку буфера через некоторое</span>
    </div>
    <div class="article__text">
      <span>время, как на настоящем оборудовании, решено не добавлять, так как</span>
    </div>
    <div class="article__text">
      <span>программа работает значительно медленнее реальных сетей и для</span>
    </div>
    <div class="article__text">
      <span>демонстрации это не понадобится.</span>
    </div>
    <div class="article__text">
      <span>Был принят в работу способ конфигурирования сети посредством</span>
    </div>
    <div class="article__text">
      <span>кнопок &quot;Добавить...&quot;.</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>  Окно коммутатора}. Принимая на один из портов пакет,</span>
    </div>
    <div class="article__text">
      <span>коммутатор сначала проверяет MAC-адрес отправителя и ищет его в</span>
    </div>
    <div class="article__text">
      <span>своей таблице MAC-адресов. Если не находит, то делает в ней</span>
    </div>
    <div class="article__text">
      <span>запись, что этот MAC доступен по порту, с которого пришло</span>
    </div>
    <div class="article__text">
      <span>сообщение. Затем проверяется MAC-адрес назначения и также ищется</span>
    </div>
    <div class="article__text">
      <span>в таблице. Если находит, пакет посылается на нужный порт, если нет</span>
    </div>
    <div class="article__text">
      <span>- происходит широковещательная рассылка.</span>
    </div>
    <div class="article__text">
      <span>Для того чтобы программа нормально функционировала, на все</span>
    </div>
    <div class="article__text">
      <span>&quot;устройства&quot; добавлены переменные или их массивы (в зависимости</span>
    </div>
    <div class="article__text">
      <span>от типа), хранящие информацию о том, какие &quot;соседские&quot; порты подключены</span>
    </div>
    <div class="article__text">
      <span>к каким локальным портам (имитация соединения проводом). Иначе</span>
    </div>
    <div class="article__text">
      <span>окна знали бы только на какой порт пришёл пакет, но не с какого на</span>
    </div>
    <div class="article__text">
      <span>соседнем &quot;устройстве&quot;.</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span> Окно маршрутизатора}. Его отличает от коммутатора то,</span>
    </div>
    <div class="article__text">
      <span> что он</span>
    </div>
    <div class="article__text">
      <span>работает с обычными адресами, а не с MAC. А также то, что</span>
    </div>
    <div class="article__text">
      <span>маршрутизаторы обмениваются между собой таблицами</span>
    </div>
    <div class="article__text">
      <span>маршрутизации. В</span>
    </div>
    <div class="article__text">
      <span>программе это происходит при изменении топологии сети,</span>
    </div>
    <div class="article__text">
      <span>инициализированном с одного из них.</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span> Во все окна (кроме коммутатора) добавлена возможность</span>
    </div>
    <div class="article__text">
      <span>назначить адрес, а в компьютеры и злоумышленника - ещё</span>
    </div>
    <div class="article__text">
      <span>возможность назначить шлюз. Это сделано для имитации локальной</span>
    </div>
    <div class="article__text">
      <span>(доменной)</span>
    </div>
    <div class="article__text">
      <span> сети</span>
    </div>
    <div class="article__text">
      <span>и внешней (интернет). В окно злоумышленника добавлена также</span>
    </div>
    <div class="article__text">
      <span>возможность отправить пакет, собранный из отдельных &quot;кусочков&quot;,</span>
    </div>
    <div class="article__text">
      <span>каждый из которых задаётся в отдельности.</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span> Атаки были протестированы.</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span> </span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>Там, где в реальности для атаки необходимо большое количество</span>
    </div>
    <div class="article__text">
      <span>хостов, мы ограничимся двумя-тремя. Программа использует свою</span>
    </div>
    <div class="article__text">
      <span>структуру сетевого пакета в отличие от реальных сетей. Это</span>
    </div>
    <div class="article__text">
      <span>допущение позволяет увеличить наглядность и упростить</span>
    </div>
    <div class="article__text">
      <span>моделирование. При запуске программы открывается окно, выступающее</span>
    </div>
    <div class="article__text">
      <span>в роли компьютера взломщика (см. рис. 1).</span>
    </div>
    <div class="article__text">
      <span>\begin{figure}[h]\centering\includegraphics[width=8cm]{gumat1.eps\caption{\footnotesize Стартовое окно (оно же -- компьютер</span>
    </div>
    <div class="article__text">
      <span>злоумышленника) }</span>
    </div>
    <div class="article__text">
      <span>\end{figure}\label{gumat1}</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>Решение начинать с него обусловлено тем, что в сети такое будет</span>
    </div>
    <div class="article__text">
      <span>одно. В окне &quot;Злоумышленник&quot; имеется возможность отправить</span>
    </div>
    <div class="article__text">
      <span>произвольное сообщение на указанный адрес внутри моделируемой</span>
    </div>
    <div class="article__text">
      <span>сети, подключить новый маршрутизатор или коммутатор. Имеется поле,</span>
    </div>
    <div class="article__text">
      <span>куда будут выводиться полученные и служебные сообщения. Основное</span>
    </div>
    <div class="article__text">
      <span>отличие этого окна от других &quot;хостов&quot; - наличие кнопки</span>
    </div>
    <div class="article__text">
      <span>&quot;Отправить с параметрами&quot;, позволяющей, используя введённые</span>
    </div>
    <div class="article__text">
      <span>пользователем данные, передать сообщение с произвольными адресами</span>
    </div>
    <div class="article__text">
      <span>назначения и отправки, а также выбранного типа. Чтобы добавить в</span>
    </div>
    <div class="article__text">
      <span>сеть новое устройство (оно будет сразу подключено к компьютеру</span>
    </div>
    <div class="article__text">
      <span>&quot;проводом&quot;), надо в два поля ввести трёхзначные адреса, первый</span>
    </div>
    <div class="article__text">
      <span>- порта компьютера с которого идёт подключение, второй --</span>
    </div>
    <div class="article__text">
      <span>подключённого &quot;проводом&quot; порта второго устройства, затем нажать</span>
    </div>
    <div class="article__text">
      <span>&quot;Добавить маршрутизатор&quot; или &quot;Добавить коммутатор&quot;.</span>
    </div>
    <div class="article__text">
      <span> Функция</span>
    </div>
    <div class="article__text">
      <span>открытия нового окна &quot;Маршрутизатор&quot; с нужными параметрами:</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>string inPort = &quot;&quot;;</span>
    </div>
    <div class="article__text">
      <span>string outPort = &quot;&quot;;</span>
    </div>
    <div class="article__text">
      <span>if (inPortBox.Text.Length != 3 || outPortBox.Text.Length != 3)</span>
    </div>
    <div class="article__text">
      <span>            {</span>
    </div>
    <div class="article__text">
      <span>                MessageBox.Show(&quot;Порты должны состоять из трех цифр&quot;);</span>
    </div>
    <div class="article__text">
      <span>                return;</span>
    </div>
    <div class="article__text">
      <span>            }</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>       //порт в родительском окне</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>inPort = inPortBox.Text;</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>  //порт в подключаемом окне</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>outPort = outPortBox.Text;</span>
    </div>
    <div class="article__text">
      <span>  //открытие порта</span>
    </div>
    <div class="article__text">
      <span>Open(inPort);</span>
    </div>
    <div class="article__text">
      <span>oppPort = outPort;</span>
    </div>
    <div class="article__text">
      <span>localPort = &quot;&quot; + inPort;</span>
    </div>
    <div class="article__text">
      <span>this.Text += &quot; &quot; + inPort;</span>
    </div>
    <div class="article__text">
      <span>CreateRouter.Visible = false;</span>
    </div>
    <div class="article__text">
      <span>inPortBox.Visible = false;</span>
    </div>
    <div class="article__text">
      <span>outPortBox.Visible = false;</span>
    </div>
    <div class="article__text">
      <span>label2.Visible = false;</span>
    </div>
    <div class="article__text">
      <span>label3.Visible = false;</span>
    </div>
    <div class="article__text">
      <span>CreateSwitch.Visible = false;</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>  //добавление нового окна и передача ему номеров</span>
    </div>
    <div class="article__text">
      <span>портов</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>    //(имитация подключения проводом)</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>Form Form2 = new Router(outPort, inPort);</span>
    </div>
    <div class="article__text">
      <span>    Form2.Show();</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>}</span>
    </div>
    <div class="article__text">
      <span>В открывшемся окне (и в маршрутизаторе, и в коммутаторе)</span>
    </div>
    <div class="article__text">
      <span>появляется</span>
    </div>
    <div class="article__text">
      <span>новая возможность - добавить в сеть новый компьютер. Принцип её</span>
    </div>
    <div class="article__text">
      <span>действия аналогичен только что рассмотренному.</span>
    </div>
    <div class="article__text">
      <span>Машина, добавленная с её помощью, сразу соединится с родительским</span>
    </div>
    <div class="article__text">
      <span>устройством (с тем, с которого она была открыта), а также не будет</span>
    </div>
    <div class="article__text">
      <span>иметь возможность добавлять новые узлы в сеть, так как будет</span>
    </div>
    <div class="article__text">
      <span>являться по сути одной из конечных точек сети.</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span> </span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span> Для демонстрации взрывного увеличения сетевого</span>
    </div>
    <div class="article__text">
      <span>трафика в программу на компьютер злоумышленника добавлена</span>
    </div>
    <div class="article__text">
      <span>возможность отослать пакет ICMP ECHO REQUEST.</span>
    </div>
    <div class="article__text">
      <span>На компьютеры, в свою очередь, добавлена функция обработки этого</span>
    </div>
    <div class="article__text">
      <span>условного пакета и отправки в ответ ICMP ECHO REPLY.</span>
    </div>
    <div class="article__text">
      <span>При отправке с компьютера злоумышленника кнопкой &quot;Отправить с</span>
    </div>
    <div class="article__text">
      <span>параметрами&quot; можно</span>
    </div>
    <div class="article__text">
      <span> выбрать</span>
    </div>
    <div class="article__text">
      <span>данные как на рисунке (см. рис. 2), тогда после первой отправки</span>
    </div>
    <div class="article__text">
      <span>инициализируется ARP--знакомство хостов, а после второй уже пойдут</span>
    </div>
    <div class="article__text">
      <span>пакеты ICMP ECHO REPLY на машину жертвы (см. рис. 3).</span>
    </div>
    <div class="article__text">
      <span>Как видно, итог - количество сообщений на канале передачи данных</span>
    </div>
    <div class="article__text">
      <span>жертвы равно количеству хостов в сети</span>
    </div>
    <div class="article__text">
      <span>(не считая двух &quot;главных</span>
    </div>
    <div class="article__text">
      <span>героев&quot;) при всего лишь одном сообщении у злоумышленника.</span>
    </div>
    <div class="article__text">
      <span>\</span>
    </div>
    <div class="article__text">
      <span>\begin{figure}[h!]\centering\includegraphics[width=8cm]{gumat2.eps\caption{\footnotesize Отправка широковещательного запроса ECHO</span>
    </div>
    <div class="article__text">
      <span>REQUEST }\centering\includegraphics[width=8cm]{gumat3.eps\caption{\footnotesize Сообщения ECHO REPLY на машине жертвы }</span>
    </div>
    <div class="article__text">
      <span>\end{figure}\label{gumat3}</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>\</span>
    </div>
    <div class="article__text">
      <span>\begin{figure}[h]\centering\includegraphics[width=8cm]{gumat4.eps\caption{\footnotesize Ответ SYN-ACK от сервера }</span>
    </div>
    <div class="article__text">
      <span>\end{figure}\label{gumat4}</span>
    </div>
    <div class="article__text">
      <span>Цикл широковещательной отправки:</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>  //отправка по всем каналам, кроме того, откуда</span>
    </div>
    <div class="article__text">
      <span>пришло</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>for (int i = 0;</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>i \lt llen; i++)</span>
    </div>
    <div class="article__text">
      <span>{</span>
    </div>
    <div class="article__text">
      <span>if (localPorts[i] != port)</span>
    </div>
    <div class="article__text">
      <span>            {</span>
    </div>
    <div class="article__text">
      <span>    Thread.Sleep(200);</span>
    </div>
    <div class="article__text">
      <span>          Send(outPorts[i], str);</span>
    </div>
    <div class="article__text">
      <span>            }</span>
    </div>
    <div class="article__text">
      <span>}</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>}</span>
    </div>
    <div class="article__text">
      <span> </span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span> Для начала демонстрации существенных задержек</span>
    </div>
    <div class="article__text">
      <span>при установке связи нужно добавить в сеть сервер. Его отличие от</span>
    </div>
    <div class="article__text">
      <span>компьютера в том, что он не принимает входящие сообщения, пока не</span>
    </div>
    <div class="article__text">
      <span>будет установлено соединение процессом &quot;тройного рукопожатия&quot;.</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>В обычной ситуации сервер отвечает пакетом SYN-ACK на все новые</span>
    </div>
    <div class="article__text">
      <span>подключения (см. рис. 4). Но если злоумышленник начнёт непрерывно</span>
    </div>
    <div class="article__text">
      <span>посылать с чужих адресов пакеты SYN на сервер, последний будет</span>
    </div>
    <div class="article__text">
      <span>добавлять эти запросы в очередь. А поскольку злоумышленник</span>
    </div>
    <div class="article__text">
      <span>отвечать на SYN-ACK сервера не будет, очередь переполнится, и не</span>
    </div>
    <div class="article__text">
      <span>останется места новым подключениям.</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>Даже при условии чистки очереди через некоторое время (тайм-аут</span>
    </div>
    <div class="article__text">
      <span>подключений) задержки будут серьезными.</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>\begin{figure}[h!]\centering\includegraphics[width=8cm]{gumat5.eps\caption{\footnotesize Отправка поддельного ARP-Reply }</span>
    </div>
    <div class="article__text">
      <span>\end{figure}\label{gumat5}</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span> </span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span> Чтобы продемонстрировать возможности</span>
    </div>
    <div class="article__text">
      <span>изменения МАС-адреса в ARP-таблице, для начала отправим сообщение</span>
    </div>
    <div class="article__text">
      <span>&quot;Первый привет&quot; с машины жертвы с внешним адресом назначения (в</span>
    </div>
    <div class="article__text">
      <span>программе это 100 и больше) на заранее созданный компьютер,</span>
    </div>
    <div class="article__text">
      <span>находящийся &quot;за&quot; маршрутизатором и имитирующий интернет.</span>
    </div>
    <div class="article__text">
      <span>Послание дойдёт до адресата. Затем отправим от злоумышленника</span>
    </div>
    <div class="article__text">
      <span>ARP-Reply с нужными параметрами (см. рис. 5), чтобы машина жертвы,</span>
    </div>
    <div class="article__text">
      <span>сопоставив IP из пакета с IP роутера, заменила его МАС-адрес на</span>
    </div>
    <div class="article__text">
      <span>новый. После этого попытка снова отправить сообщение &quot;Второй</span>
    </div>
    <div class="article__text">
      <span>привет&quot; (см. рис. 6) не увенчается успехом (см. рис. 7). Теперь</span>
    </div>
    <div class="article__text">
      <span>жертва отрезана от интернета.</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>\begin{figure}[h]\centering\includegraphics[width=8cm]{gumat6.eps\caption{\footnotesize Отправка двух сообщений }\centering\includegraphics[width=8cm]{gumat7.eps\caption{\footnotesize Получение первого сообщения }</span>
    </div>
    <div class="article__text">
      <span>\end{figure}\label{gumat7}</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span> </span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span> Демонстрация возможности перехвата</span>
    </div>
    <div class="article__text">
      <span>сетевого трафика.</span>
    </div>
    <div class="article__text">
      <span>Злоумышленник посылает поддельный пакет ARP--Reply роутеру,</span>
    </div>
    <div class="article__text">
      <span>который, сопоставив IP из пакета с IP жертвы, заменяет её</span>
    </div>
    <div class="article__text">
      <span>МАС-адрес на МАС-адрес злоумышленника.</span>
    </div>
    <div class="article__text">
      <span> Затем посылается поддельный</span>
    </div>
    <div class="article__text">
      <span>пакет ARP--Reply жертве, которая, сопоставив IP из пакета с IP</span>
    </div>
    <div class="article__text">
      <span>роутера, заменяет его МАС-адрес на МАС-адрес злоумышленника.</span>
    </div>
    <div class="article__text">
      <span>Теперь злоумышленник может просматривать исходящий сетевой трафик</span>
    </div>
    <div class="article__text">
      <span>жертвы.</span>
    </div>
    <div class="article__text">
      <span>Данная атака весьма похожа на подмену MAC-адреса, отличие в том,</span>
    </div>
    <div class="article__text">
      <span>что второе сообщение всё-таки доходит до компьютера-адресата (см.</span>
    </div>
    <div class="article__text">
      <span>рис. 8), но не напрямую, а предварительно пройдя через машину</span>
    </div>
    <div class="article__text">
      <span>злоумышленника (см. рис. 9).</span>
    </div>
    <div class="article__text">
      <span>\begin{figure}[h!]\centering\includegraphics[width=8cm]{gumat8.eps\caption{\footnotesize Получение обоих сообщений}\centering\includegraphics[width=8cm]{gumat9.eps\caption{\footnotesize  Получение сообщения злоумышленником }</span>
    </div>
    <div class="article__text">
      <span>\end{figure}\label{gumat9}</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span> </span>
    </div>
    <div class="article__title">
      <span>Smurfing</span>
    </div>
    <div class="article__text">
      <span> Для разработки использовался язык</span>
    </div>
    <div class="article__text">
      <span>программирования $C\sharp$.</span>
    </div>
    <div class="article__text">
      <span>Чтобы реализовать возможность передачи сообщений между окнами</span>
    </div>
    <div class="article__text">
      <span>программы, было решено использовать несколько встроенных классов:</span>
    </div>
    <div class="article__text">
      <span>обеспечивающих клиентские подключения для сетевых служб,</span>
    </div>
    <div class="article__text">
      <span>работающих с потоками и потоками данных.</span>
    </div>
    <div class="article__text">
      <span>В функции отправки создаётся экземпляр класса &quot;TcpClient&quot;,</span>
    </div>
    <div class="article__text">
      <span>сообщение переводится из строкового типа в байтовый массив,</span>
    </div>
    <div class="article__text">
      <span>который уже с помощью открывшегося потока передачи данных</span>
    </div>
    <div class="article__text">
      <span>посылается на указанный порт. Затем поток закрывается, а экземпляр</span>
    </div>
    <div class="article__text">
      <span>класса удаляется:</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>  //создание нового TCP клиента</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>TcpClient client = new TcpClient(&quot;localhost&quot;,</span>
    </div>
    <div class="article__text">
      <span>Convert.ToInt32(port));</span>
    </div>
    <div class="article__text">
      <span>byte[] data = new byte[256];</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>      //перевод строки в байтовый массив</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>byte[] msg = Encoding.UTF8.GetBytes(str);</span>
    </div>
    <div class="article__text">
      <span>int count = msg.Length \lt= 256 ? msg.Length : 256;</span>
    </div>
    <div class="article__text">
      <span>Array.Copy(msg, data, count);</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>  //создание потока передачи данных</span>
    </div>
    <div class="article__text">
      <span>NetworkStream stream = client.GetStream();</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>  //запись строки в поток</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>stream.Write(data, 0, 256);</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>      //закрытие потока и удаление TCP клиента</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>stream.Close();</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>client.Close();</span>
    </div>
    <div class="article__text">
      <span>textBox3.Text += &quot;Отправлено &quot; + oppPort + &quot; &quot;\gt &quot; + str;</span>
    </div>
    <div class="article__text">
      <span>textBox3.Text += Environment.NewLine;</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>}</span>
    </div>
    <div class="article__text">
      <span> Приём сообщения осуществляется сложнее. Здесь уже вступают в</span>
    </div>
    <div class="article__text">
      <span>роль потоки. Чтобы прослушивать заданный порт беспрерывно, а не по</span>
    </div>
    <div class="article__text">
      <span>нажатию кнопки, создаётся отдельный поток, который этим</span>
    </div>
    <div class="article__text">
      <span>занимается, периодически &quot;засыпая&quot;, чтобы постоянно</span>
    </div>
    <div class="article__text">
      <span> не грузить</span>
    </div>
    <div class="article__text">
      <span>систему. На каждый прослушиваемый порт создаётся свой поток,</span>
    </div>
    <div class="article__text">
      <span>благодаря чему можно принимать сообщение одновременно</span>
    </div>
    <div class="article__text">
      <span>с них всех.</span>
    </div>
    <div class="article__text">
      <span>Если в поток приёма данных попадает байтовый массив,</span>
    </div>
    <div class="article__text">
      <span>переданный с</span>
    </div>
    <div class="article__text">
      <span>другого окна, то этот массив переводится в строковую</span>
    </div>
    <div class="article__text">
      <span>переменную.</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span> Окна злоумышленника и компьютеров}. На окна злоумышленника и</span>
    </div>
    <div class="article__text">
      <span>компьютеров была добавлена возможность отправить сообщение на</span>
    </div>
    <div class="article__text">
      <span>выбранный адрес. При этом, если отправитель не знает входящий порт</span>
    </div>
    <div class="article__text">
      <span>адресата (имитация MAC-адреса),</span>
    </div>
    <div class="article__text">
      <span> то будет</span>
    </div>
    <div class="article__text">
      <span>послан широковещательный пакет ARP-Request.</span>
    </div>
    <div class="article__text">
      <span>Также</span>
    </div>
    <div class="article__text">
      <span> был добавлен</span>
    </div>
    <div class="article__text">
      <span>обработчик, проверяющий, что за сообщение нам пришло, и либо</span>
    </div>
    <div class="article__text">
      <span>отбрасывающий его, либо инициализирующий какие-то определённые</span>
    </div>
    <div class="article__text">
      <span>действия. Например, если пришёл ARP-Request - отправить в ответ</span>
    </div>
    <div class="article__text">
      <span>ARP-Reply:</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>   //Если ARP-Request</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>if (instr.Substring(13, 1) == &quot;1&quot;)</span>
    </div>
    <div class="article__text">
      <span>{</span>
    </div>
    <div class="article__text">
      <span>textBox.Text += &quot;&quot;\ltARP REQUEST от &quot; + instr.Substring(10, 3);</span>
    </div>
    <div class="article__text">
      <span>          textBox.Text += Environment.NewLine;</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>  //Обычное + Mac-адрес назначения + наш Mac-адрес +</span>
    </div>
    <div class="article__text">
      <span>адрес назначения + наш адрес + ARP-Reply</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>str += &quot;0&quot; + instr.Substring(4, 3) + localPort +</span>
    </div>
    <div class="article__text">
      <span>instr.Substring(10, 3) +    adres + &quot;2&quot;;</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>          Thread.Sleep(1000);</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>          //Отправка</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>          Send(str);</span>
    </div>
    <div class="article__text">
      <span>          return;</span>
    </div>
    <div class="article__text">
      <span>}</span>
    </div>
    <div class="article__text">
      <span>}</span>
    </div>
    <div class="article__text">
      <span> Окно сервера}. Это окно принимает не ARP--сообщения только</span>
    </div>
    <div class="article__text">
      <span>после процедуры &quot;тройного рукопожатия&quot;. После получения пакета</span>
    </div>
    <div class="article__text">
      <span>SYN сервер записывает исходящий MAC-адрес из пакета в буфер и</span>
    </div>
    <div class="article__text">
      <span>отправляет ответ SYN-ACK. Если затем придёт пакет ACK от той же</span>
    </div>
    <div class="article__text">
      <span>машины, то сервер &quot;запомнит&quot; подключение и уберёт</span>
    </div>
    <div class="article__text">
      <span>соответствующую запись из буфера. Чистку буфера через некоторое</span>
    </div>
    <div class="article__text">
      <span>время, как на настоящем оборудовании, решено не добавлять, так как</span>
    </div>
    <div class="article__text">
      <span>программа работает значительно медленнее реальных сетей и для</span>
    </div>
    <div class="article__text">
      <span>демонстрации это не понадобится.</span>
    </div>
    <div class="article__text">
      <span>Был принят в работу способ конфигурирования сети посредством</span>
    </div>
    <div class="article__text">
      <span>кнопок &quot;Добавить...&quot;.</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>  Окно коммутатора}. Принимая на один из портов пакет,</span>
    </div>
    <div class="article__text">
      <span>коммутатор сначала проверяет MAC-адрес отправителя и ищет его в</span>
    </div>
    <div class="article__text">
      <span>своей таблице MAC-адресов. Если не находит, то делает в ней</span>
    </div>
    <div class="article__text">
      <span>запись, что этот MAC доступен по порту, с которого пришло</span>
    </div>
    <div class="article__text">
      <span>сообщение. Затем проверяется MAC-адрес назначения и также ищется</span>
    </div>
    <div class="article__text">
      <span>в таблице. Если находит, пакет посылается на нужный порт, если нет</span>
    </div>
    <div class="article__text">
      <span>- происходит широковещательная рассылка.</span>
    </div>
    <div class="article__text">
      <span>Для того чтобы программа нормально функционировала, на все</span>
    </div>
    <div class="article__text">
      <span>&quot;устройства&quot; добавлены переменные или их массивы (в зависимости</span>
    </div>
    <div class="article__text">
      <span>от типа), хранящие информацию о том, какие &quot;соседские&quot; порты подключены</span>
    </div>
    <div class="article__text">
      <span>к каким локальным портам (имитация соединения проводом). Иначе</span>
    </div>
    <div class="article__text">
      <span>окна знали бы только на какой порт пришёл пакет, но не с какого на</span>
    </div>
    <div class="article__text">
      <span>соседнем &quot;устройстве&quot;.</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span> Окно маршрутизатора}. Его отличает от коммутатора то,</span>
    </div>
    <div class="article__text">
      <span> что он</span>
    </div>
    <div class="article__text">
      <span>работает с обычными адресами, а не с MAC. А также то, что</span>
    </div>
    <div class="article__text">
      <span>маршрутизаторы обмениваются между собой таблицами</span>
    </div>
    <div class="article__text">
      <span>маршрутизации. В</span>
    </div>
    <div class="article__text">
      <span>программе это происходит при изменении топологии сети,</span>
    </div>
    <div class="article__text">
      <span>инициализированном с одного из них.</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span> Во все окна (кроме коммутатора) добавлена возможность</span>
    </div>
    <div class="article__text">
      <span>назначить адрес, а в компьютеры и злоумышленника - ещё</span>
    </div>
    <div class="article__text">
      <span>возможность назначить шлюз. Это сделано для имитации локальной</span>
    </div>
    <div class="article__text">
      <span>(доменной)</span>
    </div>
    <div class="article__text">
      <span> сети</span>
    </div>
    <div class="article__text">
      <span>и внешней (интернет). В окно злоумышленника добавлена также</span>
    </div>
    <div class="article__text">
      <span>возможность отправить пакет, собранный из отдельных &quot;кусочков&quot;,</span>
    </div>
    <div class="article__text">
      <span>каждый из которых задаётся в отдельности.</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span> Атаки были протестированы.</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span> </span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>Там, где в реальности для атаки необходимо большое количество</span>
    </div>
    <div class="article__text">
      <span>хостов, мы ограничимся двумя-тремя. Программа использует свою</span>
    </div>
    <div class="article__text">
      <span>структуру сетевого пакета в отличие от реальных сетей. Это</span>
    </div>
    <div class="article__text">
      <span>допущение позволяет увеличить наглядность и упростить</span>
    </div>
    <div class="article__text">
      <span>моделирование. При запуске программы открывается окно, выступающее</span>
    </div>
    <div class="article__text">
      <span>в роли компьютера взломщика (см. рис. 1).</span>
    </div>
    <div class="article__text">
      <span>\begin{figure}[h]\centering\includegraphics[width=8cm]{gumat1.eps\caption{\footnotesize Стартовое окно (оно же -- компьютер</span>
    </div>
    <div class="article__text">
      <span>злоумышленника) }</span>
    </div>
    <div class="article__text">
      <span>\end{figure}\label{gumat1}</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>Решение начинать с него обусловлено тем, что в сети такое будет</span>
    </div>
    <div class="article__text">
      <span>одно. В окне &quot;Злоумышленник&quot; имеется возможность отправить</span>
    </div>
    <div class="article__text">
      <span>произвольное сообщение на указанный адрес внутри моделируемой</span>
    </div>
    <div class="article__text">
      <span>сети, подключить новый маршрутизатор или коммутатор. Имеется поле,</span>
    </div>
    <div class="article__text">
      <span>куда будут выводиться полученные и служебные сообщения. Основное</span>
    </div>
    <div class="article__text">
      <span>отличие этого окна от других &quot;хостов&quot; - наличие кнопки</span>
    </div>
    <div class="article__text">
      <span>&quot;Отправить с параметрами&quot;, позволяющей, используя введённые</span>
    </div>
    <div class="article__text">
      <span>пользователем данные, передать сообщение с произвольными адресами</span>
    </div>
    <div class="article__text">
      <span>назначения и отправки, а также выбранного типа. Чтобы добавить в</span>
    </div>
    <div class="article__text">
      <span>сеть новое устройство (оно будет сразу подключено к компьютеру</span>
    </div>
    <div class="article__text">
      <span>&quot;проводом&quot;), надо в два поля ввести трёхзначные адреса, первый</span>
    </div>
    <div class="article__text">
      <span>- порта компьютера с которого идёт подключение, второй --</span>
    </div>
    <div class="article__text">
      <span>подключённого &quot;проводом&quot; порта второго устройства, затем нажать</span>
    </div>
    <div class="article__text">
      <span>&quot;Добавить маршрутизатор&quot; или &quot;Добавить коммутатор&quot;.</span>
    </div>
    <div class="article__text">
      <span> Функция</span>
    </div>
    <div class="article__text">
      <span>открытия нового окна &quot;Маршрутизатор&quot; с нужными параметрами:</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>string inPort = &quot;&quot;;</span>
    </div>
    <div class="article__text">
      <span>string outPort = &quot;&quot;;</span>
    </div>
    <div class="article__text">
      <span>if (inPortBox.Text.Length != 3 || outPortBox.Text.Length != 3)</span>
    </div>
    <div class="article__text">
      <span>            {</span>
    </div>
    <div class="article__text">
      <span>                MessageBox.Show(&quot;Порты должны состоять из трех цифр&quot;);</span>
    </div>
    <div class="article__text">
      <span>                return;</span>
    </div>
    <div class="article__text">
      <span>            }</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>       //порт в родительском окне</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>inPort = inPortBox.Text;</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>  //порт в подключаемом окне</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>outPort = outPortBox.Text;</span>
    </div>
    <div class="article__text">
      <span>  //открытие порта</span>
    </div>
    <div class="article__text">
      <span>Open(inPort);</span>
    </div>
    <div class="article__text">
      <span>oppPort = outPort;</span>
    </div>
    <div class="article__text">
      <span>localPort = &quot;&quot; + inPort;</span>
    </div>
    <div class="article__text">
      <span>this.Text += &quot; &quot; + inPort;</span>
    </div>
    <div class="article__text">
      <span>CreateRouter.Visible = false;</span>
    </div>
    <div class="article__text">
      <span>inPortBox.Visible = false;</span>
    </div>
    <div class="article__text">
      <span>outPortBox.Visible = false;</span>
    </div>
    <div class="article__text">
      <span>label2.Visible = false;</span>
    </div>
    <div class="article__text">
      <span>label3.Visible = false;</span>
    </div>
    <div class="article__text">
      <span>CreateSwitch.Visible = false;</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>  //добавление нового окна и передача ему номеров</span>
    </div>
    <div class="article__text">
      <span>портов</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>    //(имитация подключения проводом)</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>Form Form2 = new Router(outPort, inPort);</span>
    </div>
    <div class="article__text">
      <span>    Form2.Show();</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>}</span>
    </div>
    <div class="article__text">
      <span>В открывшемся окне (и в маршрутизаторе, и в коммутаторе)</span>
    </div>
    <div class="article__text">
      <span>появляется</span>
    </div>
    <div class="article__text">
      <span>новая возможность - добавить в сеть новый компьютер. Принцип её</span>
    </div>
    <div class="article__text">
      <span>действия аналогичен только что рассмотренному.</span>
    </div>
    <div class="article__text">
      <span>Машина, добавленная с её помощью, сразу соединится с родительским</span>
    </div>
    <div class="article__text">
      <span>устройством (с тем, с которого она была открыта), а также не будет</span>
    </div>
    <div class="article__text">
      <span>иметь возможность добавлять новые узлы в сеть, так как будет</span>
    </div>
    <div class="article__text">
      <span>являться по сути одной из конечных точек сети.</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span> </span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span> Для демонстрации взрывного увеличения сетевого</span>
    </div>
    <div class="article__text">
      <span>трафика в программу на компьютер злоумышленника добавлена</span>
    </div>
    <div class="article__text">
      <span>возможность отослать пакет ICMP ECHO REQUEST.</span>
    </div>
    <div class="article__text">
      <span>На компьютеры, в свою очередь, добавлена функция обработки этого</span>
    </div>
    <div class="article__text">
      <span>условного пакета и отправки в ответ ICMP ECHO REPLY.</span>
    </div>
    <div class="article__text">
      <span>При отправке с компьютера злоумышленника кнопкой &quot;Отправить с</span>
    </div>
    <div class="article__text">
      <span>параметрами&quot; можно</span>
    </div>
    <div class="article__text">
      <span> выбрать</span>
    </div>
    <div class="article__text">
      <span>данные как на рисунке (см. рис. 2), тогда после первой отправки</span>
    </div>
    <div class="article__text">
      <span>инициализируется ARP--знакомство хостов, а после второй уже пойдут</span>
    </div>
    <div class="article__text">
      <span>пакеты ICMP ECHO REPLY на машину жертвы (см. рис. 3).</span>
    </div>
    <div class="article__text">
      <span>Как видно, итог - количество сообщений на канале передачи данных</span>
    </div>
    <div class="article__text">
      <span>жертвы равно количеству хостов в сети</span>
    </div>
    <div class="article__text">
      <span>(не считая двух &quot;главных</span>
    </div>
    <div class="article__text">
      <span>героев&quot;) при всего лишь одном сообщении у злоумышленника.</span>
    </div>
    <div class="article__text">
      <span>\</span>
    </div>
    <div class="article__text">
      <span>\begin{figure}[h!]\centering\includegraphics[width=8cm]{gumat2.eps\caption{\footnotesize Отправка широковещательного запроса ECHO</span>
    </div>
    <div class="article__text">
      <span>REQUEST }\centering\includegraphics[width=8cm]{gumat3.eps\caption{\footnotesize Сообщения ECHO REPLY на машине жертвы }</span>
    </div>
    <div class="article__text">
      <span>\end{figure}\label{gumat3}</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>\</span>
    </div>
    <div class="article__text">
      <span>\begin{figure}[h]\centering\includegraphics[width=8cm]{gumat4.eps\caption{\footnotesize Ответ SYN-ACK от сервера }</span>
    </div>
    <div class="article__text">
      <span>\end{figure}\label{gumat4}</span>
    </div>
    <div class="article__text">
      <span>Цикл широковещательной отправки:</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>  //отправка по всем каналам, кроме того, откуда</span>
    </div>
    <div class="article__text">
      <span>пришло</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>for (int i = 0;</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>i \lt llen; i++)</span>
    </div>
    <div class="article__text">
      <span>{</span>
    </div>
    <div class="article__text">
      <span>if (localPorts[i] != port)</span>
    </div>
    <div class="article__text">
      <span>            {</span>
    </div>
    <div class="article__text">
      <span>    Thread.Sleep(200);</span>
    </div>
    <div class="article__text">
      <span>          Send(outPorts[i], str);</span>
    </div>
    <div class="article__text">
      <span>            }</span>
    </div>
    <div class="article__text">
      <span>}</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>}</span>
    </div>
    <div class="article__text">
      <span> </span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span> Для начала демонстрации существенных задержек</span>
    </div>
    <div class="article__text">
      <span>при установке связи нужно добавить в сеть сервер. Его отличие от</span>
    </div>
    <div class="article__text">
      <span>компьютера в том, что он не принимает входящие сообщения, пока не</span>
    </div>
    <div class="article__text">
      <span>будет установлено соединение процессом &quot;тройного рукопожатия&quot;.</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>В обычной ситуации сервер отвечает пакетом SYN-ACK на все новые</span>
    </div>
    <div class="article__text">
      <span>подключения (см. рис. 4). Но если злоумышленник начнёт непрерывно</span>
    </div>
    <div class="article__text">
      <span>посылать с чужих адресов пакеты SYN на сервер, последний будет</span>
    </div>
    <div class="article__text">
      <span>добавлять эти запросы в очередь. А поскольку злоумышленник</span>
    </div>
    <div class="article__text">
      <span>отвечать на SYN-ACK сервера не будет, очередь переполнится, и не</span>
    </div>
    <div class="article__text">
      <span>останется места новым подключениям.</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>Даже при условии чистки очереди через некоторое время (тайм-аут</span>
    </div>
    <div class="article__text">
      <span>подключений) задержки будут серьезными.</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>\begin{figure}[h!]\centering\includegraphics[width=8cm]{gumat5.eps\caption{\footnotesize Отправка поддельного ARP-Reply }</span>
    </div>
    <div class="article__text">
      <span>\end{figure}\label{gumat5}</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span> </span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span> Чтобы продемонстрировать возможности</span>
    </div>
    <div class="article__text">
      <span>изменения МАС-адреса в ARP-таблице, для начала отправим сообщение</span>
    </div>
    <div class="article__text">
      <span>&quot;Первый привет&quot; с машины жертвы с внешним адресом назначения (в</span>
    </div>
    <div class="article__text">
      <span>программе это 100 и больше) на заранее созданный компьютер,</span>
    </div>
    <div class="article__text">
      <span>находящийся &quot;за&quot; маршрутизатором и имитирующий интернет.</span>
    </div>
    <div class="article__text">
      <span>Послание дойдёт до адресата. Затем отправим от злоумышленника</span>
    </div>
    <div class="article__text">
      <span>ARP-Reply с нужными параметрами (см. рис. 5), чтобы машина жертвы,</span>
    </div>
    <div class="article__text">
      <span>сопоставив IP из пакета с IP роутера, заменила его МАС-адрес на</span>
    </div>
    <div class="article__text">
      <span>новый. После этого попытка снова отправить сообщение &quot;Второй</span>
    </div>
    <div class="article__text">
      <span>привет&quot; (см. рис. 6) не увенчается успехом (см. рис. 7). Теперь</span>
    </div>
    <div class="article__text">
      <span>жертва отрезана от интернета.</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>\begin{figure}[h]\centering\includegraphics[width=8cm]{gumat6.eps\caption{\footnotesize Отправка двух сообщений }\centering\includegraphics[width=8cm]{gumat7.eps\caption{\footnotesize Получение первого сообщения }</span>
    </div>
    <div class="article__text">
      <span>\end{figure}\label{gumat7}</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span> </span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span> Демонстрация возможности перехвата</span>
    </div>
    <div class="article__text">
      <span>сетевого трафика.</span>
    </div>
    <div class="article__text">
      <span>Злоумышленник посылает поддельный пакет ARP--Reply роутеру,</span>
    </div>
    <div class="article__text">
      <span>который, сопоставив IP из пакета с IP жертвы, заменяет её</span>
    </div>
    <div class="article__text">
      <span>МАС-адрес на МАС-адрес злоумышленника.</span>
    </div>
    <div class="article__text">
      <span> Затем посылается поддельный</span>
    </div>
    <div class="article__text">
      <span>пакет ARP--Reply жертве, которая, сопоставив IP из пакета с IP</span>
    </div>
    <div class="article__text">
      <span>роутера, заменяет его МАС-адрес на МАС-адрес злоумышленника.</span>
    </div>
    <div class="article__text">
      <span>Теперь злоумышленник может просматривать исходящий сетевой трафик</span>
    </div>
    <div class="article__text">
      <span>жертвы.</span>
    </div>
    <div class="article__text">
      <span>Данная атака весьма похожа на подмену MAC-адреса, отличие в том,</span>
    </div>
    <div class="article__text">
      <span>что второе сообщение всё-таки доходит до компьютера-адресата (см.</span>
    </div>
    <div class="article__text">
      <span>рис. 8), но не напрямую, а предварительно пройдя через машину</span>
    </div>
    <div class="article__text">
      <span>злоумышленника (см. рис. 9).</span>
    </div>
    <div class="article__text">
      <span>\begin{figure}[h!]\centering\includegraphics[width=8cm]{gumat8.eps\caption{\footnotesize Получение обоих сообщений}\centering\includegraphics[width=8cm]{gumat9.eps\caption{\footnotesize  Получение сообщения злоумышленником }</span>
    </div>
    <div class="article__text">
      <span>\end{figure}\label{gumat9}</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span> </span>
    </div>
    <div class="article__title">
      <span>SYN-Flood</span>
    </div>
    <div class="article__text">
      <span> Для разработки использовался язык</span>
    </div>
    <div class="article__text">
      <span>программирования $C\sharp$.</span>
    </div>
    <div class="article__text">
      <span>Чтобы реализовать возможность передачи сообщений между окнами</span>
    </div>
    <div class="article__text">
      <span>программы, было решено использовать несколько встроенных классов:</span>
    </div>
    <div class="article__text">
      <span>обеспечивающих клиентские подключения для сетевых служб,</span>
    </div>
    <div class="article__text">
      <span>работающих с потоками и потоками данных.</span>
    </div>
    <div class="article__text">
      <span>В функции отправки создаётся экземпляр класса &quot;TcpClient&quot;,</span>
    </div>
    <div class="article__text">
      <span>сообщение переводится из строкового типа в байтовый массив,</span>
    </div>
    <div class="article__text">
      <span>который уже с помощью открывшегося потока передачи данных</span>
    </div>
    <div class="article__text">
      <span>посылается на указанный порт. Затем поток закрывается, а экземпляр</span>
    </div>
    <div class="article__text">
      <span>класса удаляется:</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>  //создание нового TCP клиента</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>TcpClient client = new TcpClient(&quot;localhost&quot;,</span>
    </div>
    <div class="article__text">
      <span>Convert.ToInt32(port));</span>
    </div>
    <div class="article__text">
      <span>byte[] data = new byte[256];</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>      //перевод строки в байтовый массив</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>byte[] msg = Encoding.UTF8.GetBytes(str);</span>
    </div>
    <div class="article__text">
      <span>int count = msg.Length \lt= 256 ? msg.Length : 256;</span>
    </div>
    <div class="article__text">
      <span>Array.Copy(msg, data, count);</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>  //создание потока передачи данных</span>
    </div>
    <div class="article__text">
      <span>NetworkStream stream = client.GetStream();</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>  //запись строки в поток</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>stream.Write(data, 0, 256);</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>      //закрытие потока и удаление TCP клиента</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>stream.Close();</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>client.Close();</span>
    </div>
    <div class="article__text">
      <span>textBox3.Text += &quot;Отправлено &quot; + oppPort + &quot; &quot;\gt &quot; + str;</span>
    </div>
    <div class="article__text">
      <span>textBox3.Text += Environment.NewLine;</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>}</span>
    </div>
    <div class="article__text">
      <span> Приём сообщения осуществляется сложнее. Здесь уже вступают в</span>
    </div>
    <div class="article__text">
      <span>роль потоки. Чтобы прослушивать заданный порт беспрерывно, а не по</span>
    </div>
    <div class="article__text">
      <span>нажатию кнопки, создаётся отдельный поток, который этим</span>
    </div>
    <div class="article__text">
      <span>занимается, периодически &quot;засыпая&quot;, чтобы постоянно</span>
    </div>
    <div class="article__text">
      <span> не грузить</span>
    </div>
    <div class="article__text">
      <span>систему. На каждый прослушиваемый порт создаётся свой поток,</span>
    </div>
    <div class="article__text">
      <span>благодаря чему можно принимать сообщение одновременно</span>
    </div>
    <div class="article__text">
      <span>с них всех.</span>
    </div>
    <div class="article__text">
      <span>Если в поток приёма данных попадает байтовый массив,</span>
    </div>
    <div class="article__text">
      <span>переданный с</span>
    </div>
    <div class="article__text">
      <span>другого окна, то этот массив переводится в строковую</span>
    </div>
    <div class="article__text">
      <span>переменную.</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span> Окна злоумышленника и компьютеров}. На окна злоумышленника и</span>
    </div>
    <div class="article__text">
      <span>компьютеров была добавлена возможность отправить сообщение на</span>
    </div>
    <div class="article__text">
      <span>выбранный адрес. При этом, если отправитель не знает входящий порт</span>
    </div>
    <div class="article__text">
      <span>адресата (имитация MAC-адреса),</span>
    </div>
    <div class="article__text">
      <span> то будет</span>
    </div>
    <div class="article__text">
      <span>послан широковещательный пакет ARP-Request.</span>
    </div>
    <div class="article__text">
      <span>Также</span>
    </div>
    <div class="article__text">
      <span> был добавлен</span>
    </div>
    <div class="article__text">
      <span>обработчик, проверяющий, что за сообщение нам пришло, и либо</span>
    </div>
    <div class="article__text">
      <span>отбрасывающий его, либо инициализирующий какие-то определённые</span>
    </div>
    <div class="article__text">
      <span>действия. Например, если пришёл ARP-Request - отправить в ответ</span>
    </div>
    <div class="article__text">
      <span>ARP-Reply:</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>   //Если ARP-Request</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>if (instr.Substring(13, 1) == &quot;1&quot;)</span>
    </div>
    <div class="article__text">
      <span>{</span>
    </div>
    <div class="article__text">
      <span>textBox.Text += &quot;&quot;\ltARP REQUEST от &quot; + instr.Substring(10, 3);</span>
    </div>
    <div class="article__text">
      <span>          textBox.Text += Environment.NewLine;</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>  //Обычное + Mac-адрес назначения + наш Mac-адрес +</span>
    </div>
    <div class="article__text">
      <span>адрес назначения + наш адрес + ARP-Reply</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>str += &quot;0&quot; + instr.Substring(4, 3) + localPort +</span>
    </div>
    <div class="article__text">
      <span>instr.Substring(10, 3) +    adres + &quot;2&quot;;</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>          Thread.Sleep(1000);</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>          //Отправка</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>          Send(str);</span>
    </div>
    <div class="article__text">
      <span>          return;</span>
    </div>
    <div class="article__text">
      <span>}</span>
    </div>
    <div class="article__text">
      <span>}</span>
    </div>
    <div class="article__text">
      <span> Окно сервера}. Это окно принимает не ARP--сообщения только</span>
    </div>
    <div class="article__text">
      <span>после процедуры &quot;тройного рукопожатия&quot;. После получения пакета</span>
    </div>
    <div class="article__text">
      <span>SYN сервер записывает исходящий MAC-адрес из пакета в буфер и</span>
    </div>
    <div class="article__text">
      <span>отправляет ответ SYN-ACK. Если затем придёт пакет ACK от той же</span>
    </div>
    <div class="article__text">
      <span>машины, то сервер &quot;запомнит&quot; подключение и уберёт</span>
    </div>
    <div class="article__text">
      <span>соответствующую запись из буфера. Чистку буфера через некоторое</span>
    </div>
    <div class="article__text">
      <span>время, как на настоящем оборудовании, решено не добавлять, так как</span>
    </div>
    <div class="article__text">
      <span>программа работает значительно медленнее реальных сетей и для</span>
    </div>
    <div class="article__text">
      <span>демонстрации это не понадобится.</span>
    </div>
    <div class="article__text">
      <span>Был принят в работу способ конфигурирования сети посредством</span>
    </div>
    <div class="article__text">
      <span>кнопок &quot;Добавить...&quot;.</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>  Окно коммутатора}. Принимая на один из портов пакет,</span>
    </div>
    <div class="article__text">
      <span>коммутатор сначала проверяет MAC-адрес отправителя и ищет его в</span>
    </div>
    <div class="article__text">
      <span>своей таблице MAC-адресов. Если не находит, то делает в ней</span>
    </div>
    <div class="article__text">
      <span>запись, что этот MAC доступен по порту, с которого пришло</span>
    </div>
    <div class="article__text">
      <span>сообщение. Затем проверяется MAC-адрес назначения и также ищется</span>
    </div>
    <div class="article__text">
      <span>в таблице. Если находит, пакет посылается на нужный порт, если нет</span>
    </div>
    <div class="article__text">
      <span>- происходит широковещательная рассылка.</span>
    </div>
    <div class="article__text">
      <span>Для того чтобы программа нормально функционировала, на все</span>
    </div>
    <div class="article__text">
      <span>&quot;устройства&quot; добавлены переменные или их массивы (в зависимости</span>
    </div>
    <div class="article__text">
      <span>от типа), хранящие информацию о том, какие &quot;соседские&quot; порты подключены</span>
    </div>
    <div class="article__text">
      <span>к каким локальным портам (имитация соединения проводом). Иначе</span>
    </div>
    <div class="article__text">
      <span>окна знали бы только на какой порт пришёл пакет, но не с какого на</span>
    </div>
    <div class="article__text">
      <span>соседнем &quot;устройстве&quot;.</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span> Окно маршрутизатора}. Его отличает от коммутатора то,</span>
    </div>
    <div class="article__text">
      <span> что он</span>
    </div>
    <div class="article__text">
      <span>работает с обычными адресами, а не с MAC. А также то, что</span>
    </div>
    <div class="article__text">
      <span>маршрутизаторы обмениваются между собой таблицами</span>
    </div>
    <div class="article__text">
      <span>маршрутизации. В</span>
    </div>
    <div class="article__text">
      <span>программе это происходит при изменении топологии сети,</span>
    </div>
    <div class="article__text">
      <span>инициализированном с одного из них.</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span> Во все окна (кроме коммутатора) добавлена возможность</span>
    </div>
    <div class="article__text">
      <span>назначить адрес, а в компьютеры и злоумышленника - ещё</span>
    </div>
    <div class="article__text">
      <span>возможность назначить шлюз. Это сделано для имитации локальной</span>
    </div>
    <div class="article__text">
      <span>(доменной)</span>
    </div>
    <div class="article__text">
      <span> сети</span>
    </div>
    <div class="article__text">
      <span>и внешней (интернет). В окно злоумышленника добавлена также</span>
    </div>
    <div class="article__text">
      <span>возможность отправить пакет, собранный из отдельных &quot;кусочков&quot;,</span>
    </div>
    <div class="article__text">
      <span>каждый из которых задаётся в отдельности.</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span> Атаки были протестированы.</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span> </span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>Там, где в реальности для атаки необходимо большое количество</span>
    </div>
    <div class="article__text">
      <span>хостов, мы ограничимся двумя-тремя. Программа использует свою</span>
    </div>
    <div class="article__text">
      <span>структуру сетевого пакета в отличие от реальных сетей. Это</span>
    </div>
    <div class="article__text">
      <span>допущение позволяет увеличить наглядность и упростить</span>
    </div>
    <div class="article__text">
      <span>моделирование. При запуске программы открывается окно, выступающее</span>
    </div>
    <div class="article__text">
      <span>в роли компьютера взломщика (см. рис. 1).</span>
    </div>
    <div class="article__text">
      <span>\begin{figure}[h]\centering\includegraphics[width=8cm]{gumat1.eps\caption{\footnotesize Стартовое окно (оно же -- компьютер</span>
    </div>
    <div class="article__text">
      <span>злоумышленника) }</span>
    </div>
    <div class="article__text">
      <span>\end{figure}\label{gumat1}</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>Решение начинать с него обусловлено тем, что в сети такое будет</span>
    </div>
    <div class="article__text">
      <span>одно. В окне &quot;Злоумышленник&quot; имеется возможность отправить</span>
    </div>
    <div class="article__text">
      <span>произвольное сообщение на указанный адрес внутри моделируемой</span>
    </div>
    <div class="article__text">
      <span>сети, подключить новый маршрутизатор или коммутатор. Имеется поле,</span>
    </div>
    <div class="article__text">
      <span>куда будут выводиться полученные и служебные сообщения. Основное</span>
    </div>
    <div class="article__text">
      <span>отличие этого окна от других &quot;хостов&quot; - наличие кнопки</span>
    </div>
    <div class="article__text">
      <span>&quot;Отправить с параметрами&quot;, позволяющей, используя введённые</span>
    </div>
    <div class="article__text">
      <span>пользователем данные, передать сообщение с произвольными адресами</span>
    </div>
    <div class="article__text">
      <span>назначения и отправки, а также выбранного типа. Чтобы добавить в</span>
    </div>
    <div class="article__text">
      <span>сеть новое устройство (оно будет сразу подключено к компьютеру</span>
    </div>
    <div class="article__text">
      <span>&quot;проводом&quot;), надо в два поля ввести трёхзначные адреса, первый</span>
    </div>
    <div class="article__text">
      <span>- порта компьютера с которого идёт подключение, второй --</span>
    </div>
    <div class="article__text">
      <span>подключённого &quot;проводом&quot; порта второго устройства, затем нажать</span>
    </div>
    <div class="article__text">
      <span>&quot;Добавить маршрутизатор&quot; или &quot;Добавить коммутатор&quot;.</span>
    </div>
    <div class="article__text">
      <span> Функция</span>
    </div>
    <div class="article__text">
      <span>открытия нового окна &quot;Маршрутизатор&quot; с нужными параметрами:</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>string inPort = &quot;&quot;;</span>
    </div>
    <div class="article__text">
      <span>string outPort = &quot;&quot;;</span>
    </div>
    <div class="article__text">
      <span>if (inPortBox.Text.Length != 3 || outPortBox.Text.Length != 3)</span>
    </div>
    <div class="article__text">
      <span>            {</span>
    </div>
    <div class="article__text">
      <span>                MessageBox.Show(&quot;Порты должны состоять из трех цифр&quot;);</span>
    </div>
    <div class="article__text">
      <span>                return;</span>
    </div>
    <div class="article__text">
      <span>            }</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>       //порт в родительском окне</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>inPort = inPortBox.Text;</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>  //порт в подключаемом окне</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>outPort = outPortBox.Text;</span>
    </div>
    <div class="article__text">
      <span>  //открытие порта</span>
    </div>
    <div class="article__text">
      <span>Open(inPort);</span>
    </div>
    <div class="article__text">
      <span>oppPort = outPort;</span>
    </div>
    <div class="article__text">
      <span>localPort = &quot;&quot; + inPort;</span>
    </div>
    <div class="article__text">
      <span>this.Text += &quot; &quot; + inPort;</span>
    </div>
    <div class="article__text">
      <span>CreateRouter.Visible = false;</span>
    </div>
    <div class="article__text">
      <span>inPortBox.Visible = false;</span>
    </div>
    <div class="article__text">
      <span>outPortBox.Visible = false;</span>
    </div>
    <div class="article__text">
      <span>label2.Visible = false;</span>
    </div>
    <div class="article__text">
      <span>label3.Visible = false;</span>
    </div>
    <div class="article__text">
      <span>CreateSwitch.Visible = false;</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>  //добавление нового окна и передача ему номеров</span>
    </div>
    <div class="article__text">
      <span>портов</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>    //(имитация подключения проводом)</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>Form Form2 = new Router(outPort, inPort);</span>
    </div>
    <div class="article__text">
      <span>    Form2.Show();</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>}</span>
    </div>
    <div class="article__text">
      <span>В открывшемся окне (и в маршрутизаторе, и в коммутаторе)</span>
    </div>
    <div class="article__text">
      <span>появляется</span>
    </div>
    <div class="article__text">
      <span>новая возможность - добавить в сеть новый компьютер. Принцип её</span>
    </div>
    <div class="article__text">
      <span>действия аналогичен только что рассмотренному.</span>
    </div>
    <div class="article__text">
      <span>Машина, добавленная с её помощью, сразу соединится с родительским</span>
    </div>
    <div class="article__text">
      <span>устройством (с тем, с которого она была открыта), а также не будет</span>
    </div>
    <div class="article__text">
      <span>иметь возможность добавлять новые узлы в сеть, так как будет</span>
    </div>
    <div class="article__text">
      <span>являться по сути одной из конечных точек сети.</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span> </span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span> Для демонстрации взрывного увеличения сетевого</span>
    </div>
    <div class="article__text">
      <span>трафика в программу на компьютер злоумышленника добавлена</span>
    </div>
    <div class="article__text">
      <span>возможность отослать пакет ICMP ECHO REQUEST.</span>
    </div>
    <div class="article__text">
      <span>На компьютеры, в свою очередь, добавлена функция обработки этого</span>
    </div>
    <div class="article__text">
      <span>условного пакета и отправки в ответ ICMP ECHO REPLY.</span>
    </div>
    <div class="article__text">
      <span>При отправке с компьютера злоумышленника кнопкой &quot;Отправить с</span>
    </div>
    <div class="article__text">
      <span>параметрами&quot; можно</span>
    </div>
    <div class="article__text">
      <span> выбрать</span>
    </div>
    <div class="article__text">
      <span>данные как на рисунке (см. рис. 2), тогда после первой отправки</span>
    </div>
    <div class="article__text">
      <span>инициализируется ARP--знакомство хостов, а после второй уже пойдут</span>
    </div>
    <div class="article__text">
      <span>пакеты ICMP ECHO REPLY на машину жертвы (см. рис. 3).</span>
    </div>
    <div class="article__text">
      <span>Как видно, итог - количество сообщений на канале передачи данных</span>
    </div>
    <div class="article__text">
      <span>жертвы равно количеству хостов в сети</span>
    </div>
    <div class="article__text">
      <span>(не считая двух &quot;главных</span>
    </div>
    <div class="article__text">
      <span>героев&quot;) при всего лишь одном сообщении у злоумышленника.</span>
    </div>
    <div class="article__text">
      <span>\</span>
    </div>
    <div class="article__text">
      <span>\begin{figure}[h!]\centering\includegraphics[width=8cm]{gumat2.eps\caption{\footnotesize Отправка широковещательного запроса ECHO</span>
    </div>
    <div class="article__text">
      <span>REQUEST }\centering\includegraphics[width=8cm]{gumat3.eps\caption{\footnotesize Сообщения ECHO REPLY на машине жертвы }</span>
    </div>
    <div class="article__text">
      <span>\end{figure}\label{gumat3}</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>\</span>
    </div>
    <div class="article__text">
      <span>\begin{figure}[h]\centering\includegraphics[width=8cm]{gumat4.eps\caption{\footnotesize Ответ SYN-ACK от сервера }</span>
    </div>
    <div class="article__text">
      <span>\end{figure}\label{gumat4}</span>
    </div>
    <div class="article__text">
      <span>Цикл широковещательной отправки:</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>  //отправка по всем каналам, кроме того, откуда</span>
    </div>
    <div class="article__text">
      <span>пришло</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>for (int i = 0;</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>i \lt llen; i++)</span>
    </div>
    <div class="article__text">
      <span>{</span>
    </div>
    <div class="article__text">
      <span>if (localPorts[i] != port)</span>
    </div>
    <div class="article__text">
      <span>            {</span>
    </div>
    <div class="article__text">
      <span>    Thread.Sleep(200);</span>
    </div>
    <div class="article__text">
      <span>          Send(outPorts[i], str);</span>
    </div>
    <div class="article__text">
      <span>            }</span>
    </div>
    <div class="article__text">
      <span>}</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>}</span>
    </div>
    <div class="article__text">
      <span> </span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span> Для начала демонстрации существенных задержек</span>
    </div>
    <div class="article__text">
      <span>при установке связи нужно добавить в сеть сервер. Его отличие от</span>
    </div>
    <div class="article__text">
      <span>компьютера в том, что он не принимает входящие сообщения, пока не</span>
    </div>
    <div class="article__text">
      <span>будет установлено соединение процессом &quot;тройного рукопожатия&quot;.</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>В обычной ситуации сервер отвечает пакетом SYN-ACK на все новые</span>
    </div>
    <div class="article__text">
      <span>подключения (см. рис. 4). Но если злоумышленник начнёт непрерывно</span>
    </div>
    <div class="article__text">
      <span>посылать с чужих адресов пакеты SYN на сервер, последний будет</span>
    </div>
    <div class="article__text">
      <span>добавлять эти запросы в очередь. А поскольку злоумышленник</span>
    </div>
    <div class="article__text">
      <span>отвечать на SYN-ACK сервера не будет, очередь переполнится, и не</span>
    </div>
    <div class="article__text">
      <span>останется места новым подключениям.</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>Даже при условии чистки очереди через некоторое время (тайм-аут</span>
    </div>
    <div class="article__text">
      <span>подключений) задержки будут серьезными.</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>\begin{figure}[h!]\centering\includegraphics[width=8cm]{gumat5.eps\caption{\footnotesize Отправка поддельного ARP-Reply }</span>
    </div>
    <div class="article__text">
      <span>\end{figure}\label{gumat5}</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span> </span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span> Чтобы продемонстрировать возможности</span>
    </div>
    <div class="article__text">
      <span>изменения МАС-адреса в ARP-таблице, для начала отправим сообщение</span>
    </div>
    <div class="article__text">
      <span>&quot;Первый привет&quot; с машины жертвы с внешним адресом назначения (в</span>
    </div>
    <div class="article__text">
      <span>программе это 100 и больше) на заранее созданный компьютер,</span>
    </div>
    <div class="article__text">
      <span>находящийся &quot;за&quot; маршрутизатором и имитирующий интернет.</span>
    </div>
    <div class="article__text">
      <span>Послание дойдёт до адресата. Затем отправим от злоумышленника</span>
    </div>
    <div class="article__text">
      <span>ARP-Reply с нужными параметрами (см. рис. 5), чтобы машина жертвы,</span>
    </div>
    <div class="article__text">
      <span>сопоставив IP из пакета с IP роутера, заменила его МАС-адрес на</span>
    </div>
    <div class="article__text">
      <span>новый. После этого попытка снова отправить сообщение &quot;Второй</span>
    </div>
    <div class="article__text">
      <span>привет&quot; (см. рис. 6) не увенчается успехом (см. рис. 7). Теперь</span>
    </div>
    <div class="article__text">
      <span>жертва отрезана от интернета.</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>\begin{figure}[h]\centering\includegraphics[width=8cm]{gumat6.eps\caption{\footnotesize Отправка двух сообщений }\centering\includegraphics[width=8cm]{gumat7.eps\caption{\footnotesize Получение первого сообщения }</span>
    </div>
    <div class="article__text">
      <span>\end{figure}\label{gumat7}</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span> </span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span> Демонстрация возможности перехвата</span>
    </div>
    <div class="article__text">
      <span>сетевого трафика.</span>
    </div>
    <div class="article__text">
      <span>Злоумышленник посылает поддельный пакет ARP--Reply роутеру,</span>
    </div>
    <div class="article__text">
      <span>который, сопоставив IP из пакета с IP жертвы, заменяет её</span>
    </div>
    <div class="article__text">
      <span>МАС-адрес на МАС-адрес злоумышленника.</span>
    </div>
    <div class="article__text">
      <span> Затем посылается поддельный</span>
    </div>
    <div class="article__text">
      <span>пакет ARP--Reply жертве, которая, сопоставив IP из пакета с IP</span>
    </div>
    <div class="article__text">
      <span>роутера, заменяет его МАС-адрес на МАС-адрес злоумышленника.</span>
    </div>
    <div class="article__text">
      <span>Теперь злоумышленник может просматривать исходящий сетевой трафик</span>
    </div>
    <div class="article__text">
      <span>жертвы.</span>
    </div>
    <div class="article__text">
      <span>Данная атака весьма похожа на подмену MAC-адреса, отличие в том,</span>
    </div>
    <div class="article__text">
      <span>что второе сообщение всё-таки доходит до компьютера-адресата (см.</span>
    </div>
    <div class="article__text">
      <span>рис. 8), но не напрямую, а предварительно пройдя через машину</span>
    </div>
    <div class="article__text">
      <span>злоумышленника (см. рис. 9).</span>
    </div>
    <div class="article__text">
      <span>\begin{figure}[h!]\centering\includegraphics[width=8cm]{gumat8.eps\caption{\footnotesize Получение обоих сообщений}\centering\includegraphics[width=8cm]{gumat9.eps\caption{\footnotesize  Получение сообщения злоумышленником }</span>
    </div>
    <div class="article__text">
      <span>\end{figure}\label{gumat9}</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span> </span>
    </div>
    <div class="article__title">
      <span>Подмена MAC-адреса</span>
    </div>
    <div class="article__text">
      <span> Для разработки использовался язык</span>
    </div>
    <div class="article__text">
      <span>программирования $C\sharp$.</span>
    </div>
    <div class="article__text">
      <span>Чтобы реализовать возможность передачи сообщений между окнами</span>
    </div>
    <div class="article__text">
      <span>программы, было решено использовать несколько встроенных классов:</span>
    </div>
    <div class="article__text">
      <span>обеспечивающих клиентские подключения для сетевых служб,</span>
    </div>
    <div class="article__text">
      <span>работающих с потоками и потоками данных.</span>
    </div>
    <div class="article__text">
      <span>В функции отправки создаётся экземпляр класса &quot;TcpClient&quot;,</span>
    </div>
    <div class="article__text">
      <span>сообщение переводится из строкового типа в байтовый массив,</span>
    </div>
    <div class="article__text">
      <span>который уже с помощью открывшегося потока передачи данных</span>
    </div>
    <div class="article__text">
      <span>посылается на указанный порт. Затем поток закрывается, а экземпляр</span>
    </div>
    <div class="article__text">
      <span>класса удаляется:</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>  //создание нового TCP клиента</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>TcpClient client = new TcpClient(&quot;localhost&quot;,</span>
    </div>
    <div class="article__text">
      <span>Convert.ToInt32(port));</span>
    </div>
    <div class="article__text">
      <span>byte[] data = new byte[256];</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>      //перевод строки в байтовый массив</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>byte[] msg = Encoding.UTF8.GetBytes(str);</span>
    </div>
    <div class="article__text">
      <span>int count = msg.Length \lt= 256 ? msg.Length : 256;</span>
    </div>
    <div class="article__text">
      <span>Array.Copy(msg, data, count);</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>  //создание потока передачи данных</span>
    </div>
    <div class="article__text">
      <span>NetworkStream stream = client.GetStream();</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>  //запись строки в поток</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>stream.Write(data, 0, 256);</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>      //закрытие потока и удаление TCP клиента</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>stream.Close();</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>client.Close();</span>
    </div>
    <div class="article__text">
      <span>textBox3.Text += &quot;Отправлено &quot; + oppPort + &quot; &quot;\gt &quot; + str;</span>
    </div>
    <div class="article__text">
      <span>textBox3.Text += Environment.NewLine;</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>}</span>
    </div>
    <div class="article__text">
      <span> Приём сообщения осуществляется сложнее. Здесь уже вступают в</span>
    </div>
    <div class="article__text">
      <span>роль потоки. Чтобы прослушивать заданный порт беспрерывно, а не по</span>
    </div>
    <div class="article__text">
      <span>нажатию кнопки, создаётся отдельный поток, который этим</span>
    </div>
    <div class="article__text">
      <span>занимается, периодически &quot;засыпая&quot;, чтобы постоянно</span>
    </div>
    <div class="article__text">
      <span> не грузить</span>
    </div>
    <div class="article__text">
      <span>систему. На каждый прослушиваемый порт создаётся свой поток,</span>
    </div>
    <div class="article__text">
      <span>благодаря чему можно принимать сообщение одновременно</span>
    </div>
    <div class="article__text">
      <span>с них всех.</span>
    </div>
    <div class="article__text">
      <span>Если в поток приёма данных попадает байтовый массив,</span>
    </div>
    <div class="article__text">
      <span>переданный с</span>
    </div>
    <div class="article__text">
      <span>другого окна, то этот массив переводится в строковую</span>
    </div>
    <div class="article__text">
      <span>переменную.</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span> Окна злоумышленника и компьютеров}. На окна злоумышленника и</span>
    </div>
    <div class="article__text">
      <span>компьютеров была добавлена возможность отправить сообщение на</span>
    </div>
    <div class="article__text">
      <span>выбранный адрес. При этом, если отправитель не знает входящий порт</span>
    </div>
    <div class="article__text">
      <span>адресата (имитация MAC-адреса),</span>
    </div>
    <div class="article__text">
      <span> то будет</span>
    </div>
    <div class="article__text">
      <span>послан широковещательный пакет ARP-Request.</span>
    </div>
    <div class="article__text">
      <span>Также</span>
    </div>
    <div class="article__text">
      <span> был добавлен</span>
    </div>
    <div class="article__text">
      <span>обработчик, проверяющий, что за сообщение нам пришло, и либо</span>
    </div>
    <div class="article__text">
      <span>отбрасывающий его, либо инициализирующий какие-то определённые</span>
    </div>
    <div class="article__text">
      <span>действия. Например, если пришёл ARP-Request - отправить в ответ</span>
    </div>
    <div class="article__text">
      <span>ARP-Reply:</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>   //Если ARP-Request</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>if (instr.Substring(13, 1) == &quot;1&quot;)</span>
    </div>
    <div class="article__text">
      <span>{</span>
    </div>
    <div class="article__text">
      <span>textBox.Text += &quot;&quot;\ltARP REQUEST от &quot; + instr.Substring(10, 3);</span>
    </div>
    <div class="article__text">
      <span>          textBox.Text += Environment.NewLine;</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>  //Обычное + Mac-адрес назначения + наш Mac-адрес +</span>
    </div>
    <div class="article__text">
      <span>адрес назначения + наш адрес + ARP-Reply</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>str += &quot;0&quot; + instr.Substring(4, 3) + localPort +</span>
    </div>
    <div class="article__text">
      <span>instr.Substring(10, 3) +    adres + &quot;2&quot;;</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>          Thread.Sleep(1000);</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>          //Отправка</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>          Send(str);</span>
    </div>
    <div class="article__text">
      <span>          return;</span>
    </div>
    <div class="article__text">
      <span>}</span>
    </div>
    <div class="article__text">
      <span>}</span>
    </div>
    <div class="article__text">
      <span> Окно сервера}. Это окно принимает не ARP--сообщения только</span>
    </div>
    <div class="article__text">
      <span>после процедуры &quot;тройного рукопожатия&quot;. После получения пакета</span>
    </div>
    <div class="article__text">
      <span>SYN сервер записывает исходящий MAC-адрес из пакета в буфер и</span>
    </div>
    <div class="article__text">
      <span>отправляет ответ SYN-ACK. Если затем придёт пакет ACK от той же</span>
    </div>
    <div class="article__text">
      <span>машины, то сервер &quot;запомнит&quot; подключение и уберёт</span>
    </div>
    <div class="article__text">
      <span>соответствующую запись из буфера. Чистку буфера через некоторое</span>
    </div>
    <div class="article__text">
      <span>время, как на настоящем оборудовании, решено не добавлять, так как</span>
    </div>
    <div class="article__text">
      <span>программа работает значительно медленнее реальных сетей и для</span>
    </div>
    <div class="article__text">
      <span>демонстрации это не понадобится.</span>
    </div>
    <div class="article__text">
      <span>Был принят в работу способ конфигурирования сети посредством</span>
    </div>
    <div class="article__text">
      <span>кнопок &quot;Добавить...&quot;.</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>  Окно коммутатора}. Принимая на один из портов пакет,</span>
    </div>
    <div class="article__text">
      <span>коммутатор сначала проверяет MAC-адрес отправителя и ищет его в</span>
    </div>
    <div class="article__text">
      <span>своей таблице MAC-адресов. Если не находит, то делает в ней</span>
    </div>
    <div class="article__text">
      <span>запись, что этот MAC доступен по порту, с которого пришло</span>
    </div>
    <div class="article__text">
      <span>сообщение. Затем проверяется MAC-адрес назначения и также ищется</span>
    </div>
    <div class="article__text">
      <span>в таблице. Если находит, пакет посылается на нужный порт, если нет</span>
    </div>
    <div class="article__text">
      <span>- происходит широковещательная рассылка.</span>
    </div>
    <div class="article__text">
      <span>Для того чтобы программа нормально функционировала, на все</span>
    </div>
    <div class="article__text">
      <span>&quot;устройства&quot; добавлены переменные или их массивы (в зависимости</span>
    </div>
    <div class="article__text">
      <span>от типа), хранящие информацию о том, какие &quot;соседские&quot; порты подключены</span>
    </div>
    <div class="article__text">
      <span>к каким локальным портам (имитация соединения проводом). Иначе</span>
    </div>
    <div class="article__text">
      <span>окна знали бы только на какой порт пришёл пакет, но не с какого на</span>
    </div>
    <div class="article__text">
      <span>соседнем &quot;устройстве&quot;.</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span> Окно маршрутизатора}. Его отличает от коммутатора то,</span>
    </div>
    <div class="article__text">
      <span> что он</span>
    </div>
    <div class="article__text">
      <span>работает с обычными адресами, а не с MAC. А также то, что</span>
    </div>
    <div class="article__text">
      <span>маршрутизаторы обмениваются между собой таблицами</span>
    </div>
    <div class="article__text">
      <span>маршрутизации. В</span>
    </div>
    <div class="article__text">
      <span>программе это происходит при изменении топологии сети,</span>
    </div>
    <div class="article__text">
      <span>инициализированном с одного из них.</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span> Во все окна (кроме коммутатора) добавлена возможность</span>
    </div>
    <div class="article__text">
      <span>назначить адрес, а в компьютеры и злоумышленника - ещё</span>
    </div>
    <div class="article__text">
      <span>возможность назначить шлюз. Это сделано для имитации локальной</span>
    </div>
    <div class="article__text">
      <span>(доменной)</span>
    </div>
    <div class="article__text">
      <span> сети</span>
    </div>
    <div class="article__text">
      <span>и внешней (интернет). В окно злоумышленника добавлена также</span>
    </div>
    <div class="article__text">
      <span>возможность отправить пакет, собранный из отдельных &quot;кусочков&quot;,</span>
    </div>
    <div class="article__text">
      <span>каждый из которых задаётся в отдельности.</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span> Атаки были протестированы.</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span> </span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>Там, где в реальности для атаки необходимо большое количество</span>
    </div>
    <div class="article__text">
      <span>хостов, мы ограничимся двумя-тремя. Программа использует свою</span>
    </div>
    <div class="article__text">
      <span>структуру сетевого пакета в отличие от реальных сетей. Это</span>
    </div>
    <div class="article__text">
      <span>допущение позволяет увеличить наглядность и упростить</span>
    </div>
    <div class="article__text">
      <span>моделирование. При запуске программы открывается окно, выступающее</span>
    </div>
    <div class="article__text">
      <span>в роли компьютера взломщика (см. рис. 1).</span>
    </div>
    <div class="article__text">
      <span>\begin{figure}[h]\centering\includegraphics[width=8cm]{gumat1.eps\caption{\footnotesize Стартовое окно (оно же -- компьютер</span>
    </div>
    <div class="article__text">
      <span>злоумышленника) }</span>
    </div>
    <div class="article__text">
      <span>\end{figure}\label{gumat1}</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>Решение начинать с него обусловлено тем, что в сети такое будет</span>
    </div>
    <div class="article__text">
      <span>одно. В окне &quot;Злоумышленник&quot; имеется возможность отправить</span>
    </div>
    <div class="article__text">
      <span>произвольное сообщение на указанный адрес внутри моделируемой</span>
    </div>
    <div class="article__text">
      <span>сети, подключить новый маршрутизатор или коммутатор. Имеется поле,</span>
    </div>
    <div class="article__text">
      <span>куда будут выводиться полученные и служебные сообщения. Основное</span>
    </div>
    <div class="article__text">
      <span>отличие этого окна от других &quot;хостов&quot; - наличие кнопки</span>
    </div>
    <div class="article__text">
      <span>&quot;Отправить с параметрами&quot;, позволяющей, используя введённые</span>
    </div>
    <div class="article__text">
      <span>пользователем данные, передать сообщение с произвольными адресами</span>
    </div>
    <div class="article__text">
      <span>назначения и отправки, а также выбранного типа. Чтобы добавить в</span>
    </div>
    <div class="article__text">
      <span>сеть новое устройство (оно будет сразу подключено к компьютеру</span>
    </div>
    <div class="article__text">
      <span>&quot;проводом&quot;), надо в два поля ввести трёхзначные адреса, первый</span>
    </div>
    <div class="article__text">
      <span>- порта компьютера с которого идёт подключение, второй --</span>
    </div>
    <div class="article__text">
      <span>подключённого &quot;проводом&quot; порта второго устройства, затем нажать</span>
    </div>
    <div class="article__text">
      <span>&quot;Добавить маршрутизатор&quot; или &quot;Добавить коммутатор&quot;.</span>
    </div>
    <div class="article__text">
      <span> Функция</span>
    </div>
    <div class="article__text">
      <span>открытия нового окна &quot;Маршрутизатор&quot; с нужными параметрами:</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>string inPort = &quot;&quot;;</span>
    </div>
    <div class="article__text">
      <span>string outPort = &quot;&quot;;</span>
    </div>
    <div class="article__text">
      <span>if (inPortBox.Text.Length != 3 || outPortBox.Text.Length != 3)</span>
    </div>
    <div class="article__text">
      <span>            {</span>
    </div>
    <div class="article__text">
      <span>                MessageBox.Show(&quot;Порты должны состоять из трех цифр&quot;);</span>
    </div>
    <div class="article__text">
      <span>                return;</span>
    </div>
    <div class="article__text">
      <span>            }</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>       //порт в родительском окне</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>inPort = inPortBox.Text;</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>  //порт в подключаемом окне</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>outPort = outPortBox.Text;</span>
    </div>
    <div class="article__text">
      <span>  //открытие порта</span>
    </div>
    <div class="article__text">
      <span>Open(inPort);</span>
    </div>
    <div class="article__text">
      <span>oppPort = outPort;</span>
    </div>
    <div class="article__text">
      <span>localPort = &quot;&quot; + inPort;</span>
    </div>
    <div class="article__text">
      <span>this.Text += &quot; &quot; + inPort;</span>
    </div>
    <div class="article__text">
      <span>CreateRouter.Visible = false;</span>
    </div>
    <div class="article__text">
      <span>inPortBox.Visible = false;</span>
    </div>
    <div class="article__text">
      <span>outPortBox.Visible = false;</span>
    </div>
    <div class="article__text">
      <span>label2.Visible = false;</span>
    </div>
    <div class="article__text">
      <span>label3.Visible = false;</span>
    </div>
    <div class="article__text">
      <span>CreateSwitch.Visible = false;</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>  //добавление нового окна и передача ему номеров</span>
    </div>
    <div class="article__text">
      <span>портов</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>    //(имитация подключения проводом)</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>Form Form2 = new Router(outPort, inPort);</span>
    </div>
    <div class="article__text">
      <span>    Form2.Show();</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>}</span>
    </div>
    <div class="article__text">
      <span>В открывшемся окне (и в маршрутизаторе, и в коммутаторе)</span>
    </div>
    <div class="article__text">
      <span>появляется</span>
    </div>
    <div class="article__text">
      <span>новая возможность - добавить в сеть новый компьютер. Принцип её</span>
    </div>
    <div class="article__text">
      <span>действия аналогичен только что рассмотренному.</span>
    </div>
    <div class="article__text">
      <span>Машина, добавленная с её помощью, сразу соединится с родительским</span>
    </div>
    <div class="article__text">
      <span>устройством (с тем, с которого она была открыта), а также не будет</span>
    </div>
    <div class="article__text">
      <span>иметь возможность добавлять новые узлы в сеть, так как будет</span>
    </div>
    <div class="article__text">
      <span>являться по сути одной из конечных точек сети.</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span> </span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span> Для демонстрации взрывного увеличения сетевого</span>
    </div>
    <div class="article__text">
      <span>трафика в программу на компьютер злоумышленника добавлена</span>
    </div>
    <div class="article__text">
      <span>возможность отослать пакет ICMP ECHO REQUEST.</span>
    </div>
    <div class="article__text">
      <span>На компьютеры, в свою очередь, добавлена функция обработки этого</span>
    </div>
    <div class="article__text">
      <span>условного пакета и отправки в ответ ICMP ECHO REPLY.</span>
    </div>
    <div class="article__text">
      <span>При отправке с компьютера злоумышленника кнопкой &quot;Отправить с</span>
    </div>
    <div class="article__text">
      <span>параметрами&quot; можно</span>
    </div>
    <div class="article__text">
      <span> выбрать</span>
    </div>
    <div class="article__text">
      <span>данные как на рисунке (см. рис. 2), тогда после первой отправки</span>
    </div>
    <div class="article__text">
      <span>инициализируется ARP--знакомство хостов, а после второй уже пойдут</span>
    </div>
    <div class="article__text">
      <span>пакеты ICMP ECHO REPLY на машину жертвы (см. рис. 3).</span>
    </div>
    <div class="article__text">
      <span>Как видно, итог - количество сообщений на канале передачи данных</span>
    </div>
    <div class="article__text">
      <span>жертвы равно количеству хостов в сети</span>
    </div>
    <div class="article__text">
      <span>(не считая двух &quot;главных</span>
    </div>
    <div class="article__text">
      <span>героев&quot;) при всего лишь одном сообщении у злоумышленника.</span>
    </div>
    <div class="article__text">
      <span>\</span>
    </div>
    <div class="article__text">
      <span>\begin{figure}[h!]\centering\includegraphics[width=8cm]{gumat2.eps\caption{\footnotesize Отправка широковещательного запроса ECHO</span>
    </div>
    <div class="article__text">
      <span>REQUEST }\centering\includegraphics[width=8cm]{gumat3.eps\caption{\footnotesize Сообщения ECHO REPLY на машине жертвы }</span>
    </div>
    <div class="article__text">
      <span>\end{figure}\label{gumat3}</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>\</span>
    </div>
    <div class="article__text">
      <span>\begin{figure}[h]\centering\includegraphics[width=8cm]{gumat4.eps\caption{\footnotesize Ответ SYN-ACK от сервера }</span>
    </div>
    <div class="article__text">
      <span>\end{figure}\label{gumat4}</span>
    </div>
    <div class="article__text">
      <span>Цикл широковещательной отправки:</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>  //отправка по всем каналам, кроме того, откуда</span>
    </div>
    <div class="article__text">
      <span>пришло</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>for (int i = 0;</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>i \lt llen; i++)</span>
    </div>
    <div class="article__text">
      <span>{</span>
    </div>
    <div class="article__text">
      <span>if (localPorts[i] != port)</span>
    </div>
    <div class="article__text">
      <span>            {</span>
    </div>
    <div class="article__text">
      <span>    Thread.Sleep(200);</span>
    </div>
    <div class="article__text">
      <span>          Send(outPorts[i], str);</span>
    </div>
    <div class="article__text">
      <span>            }</span>
    </div>
    <div class="article__text">
      <span>}</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>}</span>
    </div>
    <div class="article__text">
      <span> </span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span> Для начала демонстрации существенных задержек</span>
    </div>
    <div class="article__text">
      <span>при установке связи нужно добавить в сеть сервер. Его отличие от</span>
    </div>
    <div class="article__text">
      <span>компьютера в том, что он не принимает входящие сообщения, пока не</span>
    </div>
    <div class="article__text">
      <span>будет установлено соединение процессом &quot;тройного рукопожатия&quot;.</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>В обычной ситуации сервер отвечает пакетом SYN-ACK на все новые</span>
    </div>
    <div class="article__text">
      <span>подключения (см. рис. 4). Но если злоумышленник начнёт непрерывно</span>
    </div>
    <div class="article__text">
      <span>посылать с чужих адресов пакеты SYN на сервер, последний будет</span>
    </div>
    <div class="article__text">
      <span>добавлять эти запросы в очередь. А поскольку злоумышленник</span>
    </div>
    <div class="article__text">
      <span>отвечать на SYN-ACK сервера не будет, очередь переполнится, и не</span>
    </div>
    <div class="article__text">
      <span>останется места новым подключениям.</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>Даже при условии чистки очереди через некоторое время (тайм-аут</span>
    </div>
    <div class="article__text">
      <span>подключений) задержки будут серьезными.</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>\begin{figure}[h!]\centering\includegraphics[width=8cm]{gumat5.eps\caption{\footnotesize Отправка поддельного ARP-Reply }</span>
    </div>
    <div class="article__text">
      <span>\end{figure}\label{gumat5}</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span> </span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span> Чтобы продемонстрировать возможности</span>
    </div>
    <div class="article__text">
      <span>изменения МАС-адреса в ARP-таблице, для начала отправим сообщение</span>
    </div>
    <div class="article__text">
      <span>&quot;Первый привет&quot; с машины жертвы с внешним адресом назначения (в</span>
    </div>
    <div class="article__text">
      <span>программе это 100 и больше) на заранее созданный компьютер,</span>
    </div>
    <div class="article__text">
      <span>находящийся &quot;за&quot; маршрутизатором и имитирующий интернет.</span>
    </div>
    <div class="article__text">
      <span>Послание дойдёт до адресата. Затем отправим от злоумышленника</span>
    </div>
    <div class="article__text">
      <span>ARP-Reply с нужными параметрами (см. рис. 5), чтобы машина жертвы,</span>
    </div>
    <div class="article__text">
      <span>сопоставив IP из пакета с IP роутера, заменила его МАС-адрес на</span>
    </div>
    <div class="article__text">
      <span>новый. После этого попытка снова отправить сообщение &quot;Второй</span>
    </div>
    <div class="article__text">
      <span>привет&quot; (см. рис. 6) не увенчается успехом (см. рис. 7). Теперь</span>
    </div>
    <div class="article__text">
      <span>жертва отрезана от интернета.</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>\begin{figure}[h]\centering\includegraphics[width=8cm]{gumat6.eps\caption{\footnotesize Отправка двух сообщений }\centering\includegraphics[width=8cm]{gumat7.eps\caption{\footnotesize Получение первого сообщения }</span>
    </div>
    <div class="article__text">
      <span>\end{figure}\label{gumat7}</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span> </span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span> Демонстрация возможности перехвата</span>
    </div>
    <div class="article__text">
      <span>сетевого трафика.</span>
    </div>
    <div class="article__text">
      <span>Злоумышленник посылает поддельный пакет ARP--Reply роутеру,</span>
    </div>
    <div class="article__text">
      <span>который, сопоставив IP из пакета с IP жертвы, заменяет её</span>
    </div>
    <div class="article__text">
      <span>МАС-адрес на МАС-адрес злоумышленника.</span>
    </div>
    <div class="article__text">
      <span> Затем посылается поддельный</span>
    </div>
    <div class="article__text">
      <span>пакет ARP--Reply жертве, которая, сопоставив IP из пакета с IP</span>
    </div>
    <div class="article__text">
      <span>роутера, заменяет его МАС-адрес на МАС-адрес злоумышленника.</span>
    </div>
    <div class="article__text">
      <span>Теперь злоумышленник может просматривать исходящий сетевой трафик</span>
    </div>
    <div class="article__text">
      <span>жертвы.</span>
    </div>
    <div class="article__text">
      <span>Данная атака весьма похожа на подмену MAC-адреса, отличие в том,</span>
    </div>
    <div class="article__text">
      <span>что второе сообщение всё-таки доходит до компьютера-адресата (см.</span>
    </div>
    <div class="article__text">
      <span>рис. 8), но не напрямую, а предварительно пройдя через машину</span>
    </div>
    <div class="article__text">
      <span>злоумышленника (см. рис. 9).</span>
    </div>
    <div class="article__text">
      <span>\begin{figure}[h!]\centering\includegraphics[width=8cm]{gumat8.eps\caption{\footnotesize Получение обоих сообщений}\centering\includegraphics[width=8cm]{gumat9.eps\caption{\footnotesize  Получение сообщения злоумышленником }</span>
    </div>
    <div class="article__text">
      <span>\end{figure}\label{gumat9}</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span> </span>
    </div>
    <div class="article__title">
      <span>ARP-spoofing</span>
    </div>
    <div class="article__text">
      <span> Для разработки использовался язык</span>
    </div>
    <div class="article__text">
      <span>программирования $C\sharp$.</span>
    </div>
    <div class="article__text">
      <span>Чтобы реализовать возможность передачи сообщений между окнами</span>
    </div>
    <div class="article__text">
      <span>программы, было решено использовать несколько встроенных классов:</span>
    </div>
    <div class="article__text">
      <span>обеспечивающих клиентские подключения для сетевых служб,</span>
    </div>
    <div class="article__text">
      <span>работающих с потоками и потоками данных.</span>
    </div>
    <div class="article__text">
      <span>В функции отправки создаётся экземпляр класса &quot;TcpClient&quot;,</span>
    </div>
    <div class="article__text">
      <span>сообщение переводится из строкового типа в байтовый массив,</span>
    </div>
    <div class="article__text">
      <span>который уже с помощью открывшегося потока передачи данных</span>
    </div>
    <div class="article__text">
      <span>посылается на указанный порт. Затем поток закрывается, а экземпляр</span>
    </div>
    <div class="article__text">
      <span>класса удаляется:</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>  //создание нового TCP клиента</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>TcpClient client = new TcpClient(&quot;localhost&quot;,</span>
    </div>
    <div class="article__text">
      <span>Convert.ToInt32(port));</span>
    </div>
    <div class="article__text">
      <span>byte[] data = new byte[256];</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>      //перевод строки в байтовый массив</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>byte[] msg = Encoding.UTF8.GetBytes(str);</span>
    </div>
    <div class="article__text">
      <span>int count = msg.Length \lt= 256 ? msg.Length : 256;</span>
    </div>
    <div class="article__text">
      <span>Array.Copy(msg, data, count);</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>  //создание потока передачи данных</span>
    </div>
    <div class="article__text">
      <span>NetworkStream stream = client.GetStream();</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>  //запись строки в поток</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>stream.Write(data, 0, 256);</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>      //закрытие потока и удаление TCP клиента</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>stream.Close();</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>client.Close();</span>
    </div>
    <div class="article__text">
      <span>textBox3.Text += &quot;Отправлено &quot; + oppPort + &quot; &quot;\gt &quot; + str;</span>
    </div>
    <div class="article__text">
      <span>textBox3.Text += Environment.NewLine;</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>}</span>
    </div>
    <div class="article__text">
      <span> Приём сообщения осуществляется сложнее. Здесь уже вступают в</span>
    </div>
    <div class="article__text">
      <span>роль потоки. Чтобы прослушивать заданный порт беспрерывно, а не по</span>
    </div>
    <div class="article__text">
      <span>нажатию кнопки, создаётся отдельный поток, который этим</span>
    </div>
    <div class="article__text">
      <span>занимается, периодически &quot;засыпая&quot;, чтобы постоянно</span>
    </div>
    <div class="article__text">
      <span> не грузить</span>
    </div>
    <div class="article__text">
      <span>систему. На каждый прослушиваемый порт создаётся свой поток,</span>
    </div>
    <div class="article__text">
      <span>благодаря чему можно принимать сообщение одновременно</span>
    </div>
    <div class="article__text">
      <span>с них всех.</span>
    </div>
    <div class="article__text">
      <span>Если в поток приёма данных попадает байтовый массив,</span>
    </div>
    <div class="article__text">
      <span>переданный с</span>
    </div>
    <div class="article__text">
      <span>другого окна, то этот массив переводится в строковую</span>
    </div>
    <div class="article__text">
      <span>переменную.</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span> Окна злоумышленника и компьютеров}. На окна злоумышленника и</span>
    </div>
    <div class="article__text">
      <span>компьютеров была добавлена возможность отправить сообщение на</span>
    </div>
    <div class="article__text">
      <span>выбранный адрес. При этом, если отправитель не знает входящий порт</span>
    </div>
    <div class="article__text">
      <span>адресата (имитация MAC-адреса),</span>
    </div>
    <div class="article__text">
      <span> то будет</span>
    </div>
    <div class="article__text">
      <span>послан широковещательный пакет ARP-Request.</span>
    </div>
    <div class="article__text">
      <span>Также</span>
    </div>
    <div class="article__text">
      <span> был добавлен</span>
    </div>
    <div class="article__text">
      <span>обработчик, проверяющий, что за сообщение нам пришло, и либо</span>
    </div>
    <div class="article__text">
      <span>отбрасывающий его, либо инициализирующий какие-то определённые</span>
    </div>
    <div class="article__text">
      <span>действия. Например, если пришёл ARP-Request - отправить в ответ</span>
    </div>
    <div class="article__text">
      <span>ARP-Reply:</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>   //Если ARP-Request</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>if (instr.Substring(13, 1) == &quot;1&quot;)</span>
    </div>
    <div class="article__text">
      <span>{</span>
    </div>
    <div class="article__text">
      <span>textBox.Text += &quot;&quot;\ltARP REQUEST от &quot; + instr.Substring(10, 3);</span>
    </div>
    <div class="article__text">
      <span>          textBox.Text += Environment.NewLine;</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>  //Обычное + Mac-адрес назначения + наш Mac-адрес +</span>
    </div>
    <div class="article__text">
      <span>адрес назначения + наш адрес + ARP-Reply</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>str += &quot;0&quot; + instr.Substring(4, 3) + localPort +</span>
    </div>
    <div class="article__text">
      <span>instr.Substring(10, 3) +    adres + &quot;2&quot;;</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>          Thread.Sleep(1000);</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>          //Отправка</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>          Send(str);</span>
    </div>
    <div class="article__text">
      <span>          return;</span>
    </div>
    <div class="article__text">
      <span>}</span>
    </div>
    <div class="article__text">
      <span>}</span>
    </div>
    <div class="article__text">
      <span> Окно сервера}. Это окно принимает не ARP--сообщения только</span>
    </div>
    <div class="article__text">
      <span>после процедуры &quot;тройного рукопожатия&quot;. После получения пакета</span>
    </div>
    <div class="article__text">
      <span>SYN сервер записывает исходящий MAC-адрес из пакета в буфер и</span>
    </div>
    <div class="article__text">
      <span>отправляет ответ SYN-ACK. Если затем придёт пакет ACK от той же</span>
    </div>
    <div class="article__text">
      <span>машины, то сервер &quot;запомнит&quot; подключение и уберёт</span>
    </div>
    <div class="article__text">
      <span>соответствующую запись из буфера. Чистку буфера через некоторое</span>
    </div>
    <div class="article__text">
      <span>время, как на настоящем оборудовании, решено не добавлять, так как</span>
    </div>
    <div class="article__text">
      <span>программа работает значительно медленнее реальных сетей и для</span>
    </div>
    <div class="article__text">
      <span>демонстрации это не понадобится.</span>
    </div>
    <div class="article__text">
      <span>Был принят в работу способ конфигурирования сети посредством</span>
    </div>
    <div class="article__text">
      <span>кнопок &quot;Добавить...&quot;.</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>  Окно коммутатора}. Принимая на один из портов пакет,</span>
    </div>
    <div class="article__text">
      <span>коммутатор сначала проверяет MAC-адрес отправителя и ищет его в</span>
    </div>
    <div class="article__text">
      <span>своей таблице MAC-адресов. Если не находит, то делает в ней</span>
    </div>
    <div class="article__text">
      <span>запись, что этот MAC доступен по порту, с которого пришло</span>
    </div>
    <div class="article__text">
      <span>сообщение. Затем проверяется MAC-адрес назначения и также ищется</span>
    </div>
    <div class="article__text">
      <span>в таблице. Если находит, пакет посылается на нужный порт, если нет</span>
    </div>
    <div class="article__text">
      <span>- происходит широковещательная рассылка.</span>
    </div>
    <div class="article__text">
      <span>Для того чтобы программа нормально функционировала, на все</span>
    </div>
    <div class="article__text">
      <span>&quot;устройства&quot; добавлены переменные или их массивы (в зависимости</span>
    </div>
    <div class="article__text">
      <span>от типа), хранящие информацию о том, какие &quot;соседские&quot; порты подключены</span>
    </div>
    <div class="article__text">
      <span>к каким локальным портам (имитация соединения проводом). Иначе</span>
    </div>
    <div class="article__text">
      <span>окна знали бы только на какой порт пришёл пакет, но не с какого на</span>
    </div>
    <div class="article__text">
      <span>соседнем &quot;устройстве&quot;.</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span> Окно маршрутизатора}. Его отличает от коммутатора то,</span>
    </div>
    <div class="article__text">
      <span> что он</span>
    </div>
    <div class="article__text">
      <span>работает с обычными адресами, а не с MAC. А также то, что</span>
    </div>
    <div class="article__text">
      <span>маршрутизаторы обмениваются между собой таблицами</span>
    </div>
    <div class="article__text">
      <span>маршрутизации. В</span>
    </div>
    <div class="article__text">
      <span>программе это происходит при изменении топологии сети,</span>
    </div>
    <div class="article__text">
      <span>инициализированном с одного из них.</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span> Во все окна (кроме коммутатора) добавлена возможность</span>
    </div>
    <div class="article__text">
      <span>назначить адрес, а в компьютеры и злоумышленника - ещё</span>
    </div>
    <div class="article__text">
      <span>возможность назначить шлюз. Это сделано для имитации локальной</span>
    </div>
    <div class="article__text">
      <span>(доменной)</span>
    </div>
    <div class="article__text">
      <span> сети</span>
    </div>
    <div class="article__text">
      <span>и внешней (интернет). В окно злоумышленника добавлена также</span>
    </div>
    <div class="article__text">
      <span>возможность отправить пакет, собранный из отдельных &quot;кусочков&quot;,</span>
    </div>
    <div class="article__text">
      <span>каждый из которых задаётся в отдельности.</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span> Атаки были протестированы.</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span> </span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>Там, где в реальности для атаки необходимо большое количество</span>
    </div>
    <div class="article__text">
      <span>хостов, мы ограничимся двумя-тремя. Программа использует свою</span>
    </div>
    <div class="article__text">
      <span>структуру сетевого пакета в отличие от реальных сетей. Это</span>
    </div>
    <div class="article__text">
      <span>допущение позволяет увеличить наглядность и упростить</span>
    </div>
    <div class="article__text">
      <span>моделирование. При запуске программы открывается окно, выступающее</span>
    </div>
    <div class="article__text">
      <span>в роли компьютера взломщика (см. рис. 1).</span>
    </div>
    <div class="article__text">
      <span>\begin{figure}[h]\centering\includegraphics[width=8cm]{gumat1.eps\caption{\footnotesize Стартовое окно (оно же -- компьютер</span>
    </div>
    <div class="article__text">
      <span>злоумышленника) }</span>
    </div>
    <div class="article__text">
      <span>\end{figure}\label{gumat1}</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>Решение начинать с него обусловлено тем, что в сети такое будет</span>
    </div>
    <div class="article__text">
      <span>одно. В окне &quot;Злоумышленник&quot; имеется возможность отправить</span>
    </div>
    <div class="article__text">
      <span>произвольное сообщение на указанный адрес внутри моделируемой</span>
    </div>
    <div class="article__text">
      <span>сети, подключить новый маршрутизатор или коммутатор. Имеется поле,</span>
    </div>
    <div class="article__text">
      <span>куда будут выводиться полученные и служебные сообщения. Основное</span>
    </div>
    <div class="article__text">
      <span>отличие этого окна от других &quot;хостов&quot; - наличие кнопки</span>
    </div>
    <div class="article__text">
      <span>&quot;Отправить с параметрами&quot;, позволяющей, используя введённые</span>
    </div>
    <div class="article__text">
      <span>пользователем данные, передать сообщение с произвольными адресами</span>
    </div>
    <div class="article__text">
      <span>назначения и отправки, а также выбранного типа. Чтобы добавить в</span>
    </div>
    <div class="article__text">
      <span>сеть новое устройство (оно будет сразу подключено к компьютеру</span>
    </div>
    <div class="article__text">
      <span>&quot;проводом&quot;), надо в два поля ввести трёхзначные адреса, первый</span>
    </div>
    <div class="article__text">
      <span>- порта компьютера с которого идёт подключение, второй --</span>
    </div>
    <div class="article__text">
      <span>подключённого &quot;проводом&quot; порта второго устройства, затем нажать</span>
    </div>
    <div class="article__text">
      <span>&quot;Добавить маршрутизатор&quot; или &quot;Добавить коммутатор&quot;.</span>
    </div>
    <div class="article__text">
      <span> Функция</span>
    </div>
    <div class="article__text">
      <span>открытия нового окна &quot;Маршрутизатор&quot; с нужными параметрами:</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>string inPort = &quot;&quot;;</span>
    </div>
    <div class="article__text">
      <span>string outPort = &quot;&quot;;</span>
    </div>
    <div class="article__text">
      <span>if (inPortBox.Text.Length != 3 || outPortBox.Text.Length != 3)</span>
    </div>
    <div class="article__text">
      <span>            {</span>
    </div>
    <div class="article__text">
      <span>                MessageBox.Show(&quot;Порты должны состоять из трех цифр&quot;);</span>
    </div>
    <div class="article__text">
      <span>                return;</span>
    </div>
    <div class="article__text">
      <span>            }</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>       //порт в родительском окне</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>inPort = inPortBox.Text;</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>  //порт в подключаемом окне</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>outPort = outPortBox.Text;</span>
    </div>
    <div class="article__text">
      <span>  //открытие порта</span>
    </div>
    <div class="article__text">
      <span>Open(inPort);</span>
    </div>
    <div class="article__text">
      <span>oppPort = outPort;</span>
    </div>
    <div class="article__text">
      <span>localPort = &quot;&quot; + inPort;</span>
    </div>
    <div class="article__text">
      <span>this.Text += &quot; &quot; + inPort;</span>
    </div>
    <div class="article__text">
      <span>CreateRouter.Visible = false;</span>
    </div>
    <div class="article__text">
      <span>inPortBox.Visible = false;</span>
    </div>
    <div class="article__text">
      <span>outPortBox.Visible = false;</span>
    </div>
    <div class="article__text">
      <span>label2.Visible = false;</span>
    </div>
    <div class="article__text">
      <span>label3.Visible = false;</span>
    </div>
    <div class="article__text">
      <span>CreateSwitch.Visible = false;</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>  //добавление нового окна и передача ему номеров</span>
    </div>
    <div class="article__text">
      <span>портов</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>    //(имитация подключения проводом)</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>Form Form2 = new Router(outPort, inPort);</span>
    </div>
    <div class="article__text">
      <span>    Form2.Show();</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>}</span>
    </div>
    <div class="article__text">
      <span>В открывшемся окне (и в маршрутизаторе, и в коммутаторе)</span>
    </div>
    <div class="article__text">
      <span>появляется</span>
    </div>
    <div class="article__text">
      <span>новая возможность - добавить в сеть новый компьютер. Принцип её</span>
    </div>
    <div class="article__text">
      <span>действия аналогичен только что рассмотренному.</span>
    </div>
    <div class="article__text">
      <span>Машина, добавленная с её помощью, сразу соединится с родительским</span>
    </div>
    <div class="article__text">
      <span>устройством (с тем, с которого она была открыта), а также не будет</span>
    </div>
    <div class="article__text">
      <span>иметь возможность добавлять новые узлы в сеть, так как будет</span>
    </div>
    <div class="article__text">
      <span>являться по сути одной из конечных точек сети.</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span> </span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span> Для демонстрации взрывного увеличения сетевого</span>
    </div>
    <div class="article__text">
      <span>трафика в программу на компьютер злоумышленника добавлена</span>
    </div>
    <div class="article__text">
      <span>возможность отослать пакет ICMP ECHO REQUEST.</span>
    </div>
    <div class="article__text">
      <span>На компьютеры, в свою очередь, добавлена функция обработки этого</span>
    </div>
    <div class="article__text">
      <span>условного пакета и отправки в ответ ICMP ECHO REPLY.</span>
    </div>
    <div class="article__text">
      <span>При отправке с компьютера злоумышленника кнопкой &quot;Отправить с</span>
    </div>
    <div class="article__text">
      <span>параметрами&quot; можно</span>
    </div>
    <div class="article__text">
      <span> выбрать</span>
    </div>
    <div class="article__text">
      <span>данные как на рисунке (см. рис. 2), тогда после первой отправки</span>
    </div>
    <div class="article__text">
      <span>инициализируется ARP--знакомство хостов, а после второй уже пойдут</span>
    </div>
    <div class="article__text">
      <span>пакеты ICMP ECHO REPLY на машину жертвы (см. рис. 3).</span>
    </div>
    <div class="article__text">
      <span>Как видно, итог - количество сообщений на канале передачи данных</span>
    </div>
    <div class="article__text">
      <span>жертвы равно количеству хостов в сети</span>
    </div>
    <div class="article__text">
      <span>(не считая двух &quot;главных</span>
    </div>
    <div class="article__text">
      <span>героев&quot;) при всего лишь одном сообщении у злоумышленника.</span>
    </div>
    <div class="article__text">
      <span>\</span>
    </div>
    <div class="article__text">
      <span>\begin{figure}[h!]\centering\includegraphics[width=8cm]{gumat2.eps\caption{\footnotesize Отправка широковещательного запроса ECHO</span>
    </div>
    <div class="article__text">
      <span>REQUEST }\centering\includegraphics[width=8cm]{gumat3.eps\caption{\footnotesize Сообщения ECHO REPLY на машине жертвы }</span>
    </div>
    <div class="article__text">
      <span>\end{figure}\label{gumat3}</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>\</span>
    </div>
    <div class="article__text">
      <span>\begin{figure}[h]\centering\includegraphics[width=8cm]{gumat4.eps\caption{\footnotesize Ответ SYN-ACK от сервера }</span>
    </div>
    <div class="article__text">
      <span>\end{figure}\label{gumat4}</span>
    </div>
    <div class="article__text">
      <span>Цикл широковещательной отправки:</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>  //отправка по всем каналам, кроме того, откуда</span>
    </div>
    <div class="article__text">
      <span>пришло</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>for (int i = 0;</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>i \lt llen; i++)</span>
    </div>
    <div class="article__text">
      <span>{</span>
    </div>
    <div class="article__text">
      <span>if (localPorts[i] != port)</span>
    </div>
    <div class="article__text">
      <span>            {</span>
    </div>
    <div class="article__text">
      <span>    Thread.Sleep(200);</span>
    </div>
    <div class="article__text">
      <span>          Send(outPorts[i], str);</span>
    </div>
    <div class="article__text">
      <span>            }</span>
    </div>
    <div class="article__text">
      <span>}</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>}</span>
    </div>
    <div class="article__text">
      <span> </span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span> Для начала демонстрации существенных задержек</span>
    </div>
    <div class="article__text">
      <span>при установке связи нужно добавить в сеть сервер. Его отличие от</span>
    </div>
    <div class="article__text">
      <span>компьютера в том, что он не принимает входящие сообщения, пока не</span>
    </div>
    <div class="article__text">
      <span>будет установлено соединение процессом &quot;тройного рукопожатия&quot;.</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>В обычной ситуации сервер отвечает пакетом SYN-ACK на все новые</span>
    </div>
    <div class="article__text">
      <span>подключения (см. рис. 4). Но если злоумышленник начнёт непрерывно</span>
    </div>
    <div class="article__text">
      <span>посылать с чужих адресов пакеты SYN на сервер, последний будет</span>
    </div>
    <div class="article__text">
      <span>добавлять эти запросы в очередь. А поскольку злоумышленник</span>
    </div>
    <div class="article__text">
      <span>отвечать на SYN-ACK сервера не будет, очередь переполнится, и не</span>
    </div>
    <div class="article__text">
      <span>останется места новым подключениям.</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>Даже при условии чистки очереди через некоторое время (тайм-аут</span>
    </div>
    <div class="article__text">
      <span>подключений) задержки будут серьезными.</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>\begin{figure}[h!]\centering\includegraphics[width=8cm]{gumat5.eps\caption{\footnotesize Отправка поддельного ARP-Reply }</span>
    </div>
    <div class="article__text">
      <span>\end{figure}\label{gumat5}</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span> </span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span> Чтобы продемонстрировать возможности</span>
    </div>
    <div class="article__text">
      <span>изменения МАС-адреса в ARP-таблице, для начала отправим сообщение</span>
    </div>
    <div class="article__text">
      <span>&quot;Первый привет&quot; с машины жертвы с внешним адресом назначения (в</span>
    </div>
    <div class="article__text">
      <span>программе это 100 и больше) на заранее созданный компьютер,</span>
    </div>
    <div class="article__text">
      <span>находящийся &quot;за&quot; маршрутизатором и имитирующий интернет.</span>
    </div>
    <div class="article__text">
      <span>Послание дойдёт до адресата. Затем отправим от злоумышленника</span>
    </div>
    <div class="article__text">
      <span>ARP-Reply с нужными параметрами (см. рис. 5), чтобы машина жертвы,</span>
    </div>
    <div class="article__text">
      <span>сопоставив IP из пакета с IP роутера, заменила его МАС-адрес на</span>
    </div>
    <div class="article__text">
      <span>новый. После этого попытка снова отправить сообщение &quot;Второй</span>
    </div>
    <div class="article__text">
      <span>привет&quot; (см. рис. 6) не увенчается успехом (см. рис. 7). Теперь</span>
    </div>
    <div class="article__text">
      <span>жертва отрезана от интернета.</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span>\begin{figure}[h]\centering\includegraphics[width=8cm]{gumat6.eps\caption{\footnotesize Отправка двух сообщений }\centering\includegraphics[width=8cm]{gumat7.eps\caption{\footnotesize Получение первого сообщения }</span>
    </div>
    <div class="article__text">
      <span>\end{figure}\label{gumat7}</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span> </span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span> Демонстрация возможности перехвата</span>
    </div>
    <div class="article__text">
      <span>сетевого трафика.</span>
    </div>
    <div class="article__text">
      <span>Злоумышленник посылает поддельный пакет ARP--Reply роутеру,</span>
    </div>
    <div class="article__text">
      <span>который, сопоставив IP из пакета с IP жертвы, заменяет её</span>
    </div>
    <div class="article__text">
      <span>МАС-адрес на МАС-адрес злоумышленника.</span>
    </div>
    <div class="article__text">
      <span> Затем посылается поддельный</span>
    </div>
    <div class="article__text">
      <span>пакет ARP--Reply жертве, которая, сопоставив IP из пакета с IP</span>
    </div>
    <div class="article__text">
      <span>роутера, заменяет его МАС-адрес на МАС-адрес злоумышленника.</span>
    </div>
    <div class="article__text">
      <span>Теперь злоумышленник может просматривать исходящий сетевой трафик</span>
    </div>
    <div class="article__text">
      <span>жертвы.</span>
    </div>
    <div class="article__text">
      <span>Данная атака весьма похожа на подмену MAC-адреса, отличие в том,</span>
    </div>
    <div class="article__text">
      <span>что второе сообщение всё-таки доходит до компьютера-адресата (см.</span>
    </div>
    <div class="article__text">
      <span>рис. 8), но не напрямую, а предварительно пройдя через машину</span>
    </div>
    <div class="article__text">
      <span>злоумышленника (см. рис. 9).</span>
    </div>
    <div class="article__text">
      <span>\begin{figure}[h!]\centering\includegraphics[width=8cm]{gumat8.eps\caption{\footnotesize Получение обоих сообщений}\centering\includegraphics[width=8cm]{gumat9.eps\caption{\footnotesize  Получение сообщения злоумышленником }</span>
    </div>
    <div class="article__text">
      <span>\end{figure}\label{gumat9}</span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span></span>
    </div>
    <div class="article__text">
      <span> </span>
    </div>
    <div class="article__title">
      <span>Заключение</span>
    </div>
    <div class="article__text">
      <span> Разработанное программное  приложение полезно в первую очередь для обучения студентов и администраторов, которые по долгу службы должны обеспечивать безопасность информационных ресурсов. Данная работа продолжает разработки по моделированию атак на компьютерные сети посредством создания специализированного программного обеспечения, начатые в \cite{gum1,gum2}. Приложение не предусматривает демонстрацию защиты от сетевых атак.</span>
    </div>
    <div class="article__title">
      <span>Литература</span>
    </div>
    <div class="article__text">
      <ul>
        <li>1.  Гуц А.К., Эннс Е.П.  Программа, моделирующая компьютерную сеть и
сетевые атаки // Математические структуры и моделирование. 2017.
№ 3(43). С. 139--149.

</li>
        <li>2. Гуц А.К., Баженов А.В. Программное обеспечение для моделирования
сетей и имитации атак на компьютерные сети // Математические
структуры и моделирование. 2018. № 4(48). C. 99--112.

</li>
      </ul>
    </div>
  </div>
</body>