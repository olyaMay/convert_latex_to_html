\startarticle
\shrtitle{Факторный анализ для восстановления...}         % Часть названия статьи для колонтитулов.
\shrauthor{В.А.~Шовин}{В.А.~Шовин}  % Автор или группа авторов для оглавления и колонтитулов.
\udc{519.237.7}                               % Вставьте УДК.
\selectlanguage{russian}                    % Основной язык статьи 
\date{10.12.2018}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%% для русскоязычной статьи и реферирования в РИНЦ  %%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\title{Факторный анализ для восстановления пробелов данных артериальной гипертензии} 
\author{В.А.~Шовин}{научный сотрудник}{v.shovin@mail.ru} 
\affil{Институт математики им. С.Л. Соболева Сибирского отделения РАН \newline (Омский филиал), Омск, Россия}
\abstract{Разработан алгоритм заполнения пробелов данных на базе восстановления вектора показателей объектов из 
факторной структуры данных, вычисляемой с помощью метода штрафных функций. Пробелы в данных и соответствующие им 
уравнения факторной модели для отдельных объектов не учитывались в критерии оптимизации невязок уравнений факторной модели, 
что позволяет достоверно оценить значения пробелов данных. Проведён численный эксперимент, подтверждающий работоспособность 
алгоритма, и создана программа с интерфейсом, позволяющая пользователю загружать новые данные.} 
\keywords{факторный анализ, метод штрафных функций, артериальная гипертензия}

\titleEng{Factor analysis for restoring data gaps of hypertension}     
\authorEng{V.A.~Shovin}{Scientist Researcher}{v.shovin@mail.ru} % Автор на английском.
\affilEng{Institute of Mathematics S.L. Soboleva of Siberian Branch of RAS\newline (Omsk Branch), Omsk, Russia}   
\abstractEng{An algorithm for filling data gaps on the basis of restoring the vector of object indices from the factorial 
data structure, calculated with penalty method, is developed. Data gaps and the corresponding factor model equations for 
individual objects were not taken into account in the optimization criterion for residuals of the factor model equations. 
That allows to reliably estimate the values of data gaps. A numerical experiment confirming the operability of the algorithm 
is carried out and a program with an interface that allows the user to upload new data is created.} 
\keywordsEng{factor analysis, penalty method, hypertension}

\maketitle % Формирование оглавления.

%%%%%%%%%%%%%%%%%%%%%% Т Е К С Т %%%%%%%%%%%%%%%%%%%%%%%%%
\section*{Введение} % Звездочка для того, чтобы раздел не нумеровался
Факторный анализ позволяет вычислить факторную структуру данных, определив тем самым связь между латентными переменными (факторами) и исходными переменными. В классическом факторном анализе связь между факторами и исходными переменными является линейной. В факторном анализе решаются несколько задач. Это поиск матрицы факторной структуры, определяющей нагрузки переменных на факторы, т.~е. соответствует коэффициентам корреляции между исходными переменными и факторами. А также определение значений факторов (новых «латентных» переменных) у объектов. Зная значение факторов и матрицу факторной структуры, можно восстановить значения исходных переменных, тем самым очистив исходные данные от шума.

Существует несколько подходов к вычислению матрицы факторной структуры. Одним из продвинутых подходов к определению всех неизвестных параметров модели факторного анализа является метод оптимизации с проверкой на дополнительные условия или ограничения, а именно метод штрафов. В данном методе для оценки параметров и значений латентных переменных модели, задаваемой линейными уравнениями, может быть использован критерий минимальных невязок как сумма невязок модели вычисленных для всей выборки различных объектов. Дополнительно на параметры и значения латентных переменных могут быть заданы ограничительные условия. Для решения задачи минимизации невязок модели предлагается использовать методы нелинейной оптимизации с условиями: метод конфигураций. Метод штрафных функций позволяет учитывать ограничения, накладываемые на значения параметров и латентных переменных модели.

С помощью метода штрафов можно определить неизвестные параметры факторной модели и из факторной структуры данных восстановить исходные данные, тем самым восстановив пробелы в данных. Чтобы задача оптимизации невязок факторной модели была определена, в данном алгоритме восстановления пробелов данных предлагается предварительно исключить из критерия оптимизации отдельные уравнения объектов, соответствующие пробелам данных.

\section{Факторный анализ как частный случай структурных уравнений}

В теории структурных уравнений используются следующие типы матриц.

Матрица $Z\mathop{\leftrightarrow }\limits_{m\times n} z_{ij} $  ---  матрица значений измеряемых переменных у исследуемых объектов или состояний объекта размерности $m\times n$, где $m$ --- число измеряемых параметров, $n$ --- число объектов или состояний объекта (объём выборки).

Матрица $P\mathop{\leftrightarrow }\limits_{g\times n} p_{ij} $  ---  матрица значений латентных переменных объектов размерности $g\times n$, где $g$ --- число латентных параметров.

Матрица $A\mathop{\leftrightarrow }\limits_{k\times s} a_{ij} $  ---  матрица параметров структурных уравнений размерности $k\times s$, где $k$ --- число структурных уравнений, $s$ --- число параметров в структурных уравнениях.

Система структурных уравнений задаётся в виде:

\[
\left\{
   \begin{array}{c} 
     {f_{1} \left(a_{11} ,a_{12} ,\ldots ,a_{1s} ;p_{1t} ,p_{2t} ,\ldots ,p_{gt} ;z_{1t} ,z_{2t} ,\ldots ,z_{mt} \right)+\varepsilon _{1t} =0,} \\ 
     {f_{2} \left(a_{21} ,a_{22} ,\ldots ,a_{2s} ;p_{1t} ,p_{2t} ,\ldots ,p_{gt} ;z_{1t} ,z_{2t} ,\ldots ,z_{mt} \right)+\varepsilon _{2t} =0,} \\ 
     {\vdots } \\ 
     {f_{k} \left(a_{k1} ,a_{k2} ,\ldots ,a_{ks} ;p_{1t} ,p_{2t} ,\ldots ,p_{gt} ;z_{1t} ,z_{2t} ,\ldots ,z_{mt} \right)+\varepsilon _{kt} =0,} 
   \end{array}
   \right.
\] 
где  $f_{1} ,f_{2} ,\ldots ,f_{k} $  ---  в общем случае нелинейные функции своих переменных,
$\varepsilon _{1t} ,\varepsilon _{2t} ,\ldots ,\varepsilon _{kt} $  ---  невязки модели для \textit{t}-го объекта или состояния объекта.

На значения параметров и значения латентных переменных могут накладываться дополнительные условия в виде равенств и неравенств.

Оптимальными значениями параметров и латентных переменных считаются те значения, которые минимизируют абсолютные значения невязок модели и удовлетворяют всем дополнительным условиям.



В данной работе рассмотрен частный случай структурной модели\textbf{  $-$ }линейная факторная модель, описываемая следующими уравнениями \cite{svshovin, sviberla, svharman}:

\begin{equation} \label{1} \left\{\begin{array}{c} {z_{1t} =a_{11} p_{1t} +a_{12} p_{2t} +\ldots +a_{1g} p_{gt} +\varepsilon _{1t} ,} \\ {z_{2t} =a_{21} p_{1t} +a_{22} p_{2t} +\ldots +a_{2g} p_{gt} +\varepsilon _{2t} ,} \\ {\vdots } \\ {z_{mt} =a_{m1} p_{1t} +a_{m2} p_{2t} +\ldots +a_{mg} p_{gt} +\varepsilon _{mt},} \end{array}\right.  \end{equation} 
где матрица $A\mathop{\leftrightarrow }\limits_{m\times g} a_{ij} $ называется матрицей факторной структуры размерности $m\times g$ весовых коэффициентов. Где $m$ --- число изучаемых параметров,\lb $g$ --- число общих факторов.

На вид факторной структуры $A$ налагаются дополнительные ограничения:

--- общности переменных факторной структуры должны быть не больше 1, а также не меньше определённого порога значимости:
\begin{equation} 
h_{i} =\sqrt{\sum _{k=1}^{g}a_{ik}^{2}  } \le 1, \ \ \ h_{i} \ge p; 
\end{equation} 

--- критерий оптимизации задаётся в следующем виде:
\begin{equation} 
K=\sum _{t=1}^{n}\sum _{k=1}^{m}\varepsilon _{kt}^{2}; 
\end{equation} 

--- минимизация критерия $K$ и учёт дополнительных условий на вид факторной структуры приводит к оптимальному решению для варьируемых значений элементов факторной структуры $a_{ij} $ и факторов $p_{ij} $.

Оптимизацию суммы квадратов невязок линейных уравнений факторной структуры как функций от независимых переменных матрицы факторной структуры и значений факторов с ограничениями предлагается осуществлять методом штрафных функций \cite{svbandi}. В качестве метода безусловной оптимизации метода штрафных функций был выбран метод конфигураций \cite{svkokuev}.

\textbf{Вычислительный алгоритм}

Алгоритм построения линейной факторной модели:

\begin{enumer}
\item  Определение числа факторов числом $g<m$.

\item  Определение начальных приближений матрицы $A$ линейной части размерности $m\times g$ и матрицы $P$ значений факторов размерности $g\times n$ случайными числами из диапазона $\left[-1;1\right]$.

\item  Минимизация критерия (3) суммы квадратов невязок структурных уравнений (1) как функций от независимых переменных матриц $A$ факторной структуры и значений факторов $P$ с ограничениями (2) методом штрафных функций и методом конфигураций.
\end{enumer}


\section{Алгоритм восстановления пробелов данных}

На базе метода штрафов возможно вычислить факторную структуру данных и восстановить пробелы данных:

\begin{enumer}
\item   Выявить пробелы данных.

\item   Исключить из критерия невязок уравнений факторной модели уравнения объектов, соответствующие пробелам данных.

\item   Выполнить оценку неизвестных параметров линейной факторной модели по методу штрафов как задачи оптимизации невязок модели.

\item   После процедуры оценки матрицы факторной структуры и значений факторов у объектов по методу штрафов заменить значения переменных, соответствующие пробелам данных восстановленными значениями, минимизирующих невязки факторной модели.
\end{enumer}

\section{Отбраковка грубых ошибок\\ (проверка на однородность выборки)}

Таблица экспериментальных данных может содержать грубые ошибки. Грубые ошибки могут быть следствием нарушения основных условий измерения, неправильного чтения показаний измерительного прибора, просчёта, неверной записи при внесении результата измерения в таблицу. Внешним признаком результата, содержащего грубую ошибку, является его резкое отличие по величине от результатов остальных измерений. 

Для отбраковки грубых ошибок предлагается использовать следующий алгоритм:



\begin{enumer}
\item  Необходимо проверить, является ли выборка симметричной или нет.

\item  Строится вариационный ряд:
$x'_{1} \ldots x'_{n} $ $\left(x'_{1} \le x'_{2} \le \ldots \le x'_{n-1} \le x'_{n} \right)$, \lb где $x'_{i} $ --- элементы вариационного ряда, полученного из элементов $x_{i} $ проверяемой выборки. 
Анализируются крайние элементы вариационного ряда.

\item  Делается предположение, что элемент $x'_{n} $ померен с грубой ошибкой.

\item  Берётся для исследования выборка $x'_{1} \ldots x'_{n-1} $.

По выборке $x'_{1} \ldots x'_{n-1} $ строится интервал $\left(\overline{x}-3S_{x} ,\overline{x}+3S_{x} \right)$, если выборка $x'_{1} \ldots x'_{n-1} $ симметрична, или
строится интервал $\left(\overline{x}-5S_{x} ,\overline{x}+5S_{x} \right)$, если выборка $x'_{1} \ldots x'_{n-1} $ несимметрична,
где $\overline{x}$ --- выборочное математическое ожидание величин $x_{1} \ldots x_{n} $,
$S_{x} $ --- выборочное стандартное отклонение величин $x_{1} \ldots x_{n} $.

\item  Если $x'_{n}$ $\in$ интервалу, то грубой ошибки нет.

\item  Аналогично проверяется $x'_{1} $.

\item  Если $x'_{n} $ померен с грубой ошибкой, то он отбрасывается.

Элемент $x'_{1} $ рассматривается относительно выборки $x'_{2} \ldots x'_{n-1} $.


\item  И т.~д. 
\end{enumer}



$\overline{x}=\frac{1}{n} \cdot \sum _{i=1}^{n}x_{i}$ --- выборочное среднее.

$S_{x}^{2} =\frac{1}{n-1} \cdot \sum _{i=1}^{n}\left(x_{i} -\overline{x}\right)^{2}$  --- выборочная дисперсия.

Выборка считается симметричной, если величина $\delta =\left|h_{x} -\overline{x}\right|\le 3\cdot \frac{S_{x} }{\sqrt{n} } $,
где $h_{x} $ --- медиана,
\[h_{x} =\left\{\begin{array}{cc} {\begin{array}{l} {0.5\cdot \left(x'_{l} +x'_{l+1} \right),} \\ {x'_{l+1} ,} \end{array}} & {\begin{array}{l} {n=2l;} \\ {n=2l+1.} \end{array}} \end{array}\right. \] 



\section{Численный эксперимент}

В качестве исходных данных были взяты 38 биофизических показателей для 131 лица с артериальной гипертензией начальной стадии. Некоторые показатели из выборки:

\begin{enumer}
\item[1)]  \textit{вес,}

\item[2)] \textit{ индекс массы тела (ИМТ),}

\item[3)] \textit{ частота дыхания (ЧД),}

\item[4)] \textit{ сегментоядерные нейтрофилы (С),}

\item[5)] \textit{ лимфоциты (Л),}

\item[6)] \textit{ конечно-систолический размер левого желудочка (КСР),}

\item[7)] \textit{ конечно-систолический объём левого желудочка (КСО),}

\item[8)] \textit{ конечно-диастолический размер левого желудочка (КДР),}

\item[9)] \textit{ конечно-диастолический объём левого желудочка (КДО),}

\item[10)] \textit{ ударный объём (УО), }

\item[11)] \textit{ минутный объём сердца (МОС),}

\item[12)] \textit{ общее периферическое сосудистое сопротивление (ОПСС),}

\item[13)] \textit{ индекс Хильдебрандта (ИХ),}

\item[14)] \textit{ фракция выброса левого желудочка (ФВ), }

\item[15)] \textit{ фракция укорочения левого желудочка (ФУ).}
\end{enumer}

 Исходные данные содержали пробелы, соответствующие грубым ошибкам и выбросам из нормального распределения показателей.

С помощью алгоритма восстановления пробелов данных было выполнено предварительное исключение уравнений объектов факторной модели, соответствующих пробелам данных. Была проведена оценка неизвестных параметров линейной факторной модели. Количество факторов было выбрано по принципу «каменистой осыпи» независимого классического факторного анализа исходных данных. После вычисления факторной структуры пробелы данных были восстановлены. 

Оказалось, что 65~\% восстановленных пробелов, соответствующих алгоритму отбраковки грубых ошибок, оказались вне интервала минимальных и максимальных значений отдельных переменных. Тогда как только 35~\% пробелов оказались в рамках таких интервалов. Данный факт можно интерпретировать как ошибочное определение грубых ошибок в виду рассмотрения независимых нормальных распределений отдельных переменных, а не многомерного нормального распределения. Скорее всего, лишь 35~\% выявленных грубых ошибок оказались истинными.

Алгоритм, учитывающий многомерность распределения данных, не смог исправить 65~\% грубых ошибок. То есть это были не грубые ошибки, а результат совместного однонаправленного воздействия со стороны различных факторов. Такие выбросы из многомерного или части одномерных нормальных распределений являются естественным результатом однонаправленного воздействия различных факторов.

Оставшиеся 35~\% выявленных грубых ошибок как выбросы из одномерных нормальных распределений оказались после восстановления в рамках нормального распределения, что свидетельствует о том, что это были истинные выбросы. То есть после восстановления эти выбросы оказались в рамках нормальных распределений. В то время как остальные 65~\% остались вне нормальных распределений.

Всё это свидетельствует о том, что при оценке значений и проверке их на нормальное распределение или выбросы нельзя рассматривать независимо только это значение и этот показатель отдельно от других. В том числе нельзя утверждать, что такова организационная система показателей: в данном случае человек имеет плохую биологическую организацию и плохое функциональное состояние. Нарушение значений показателей из одномерного нормального распределения может быть результатом компенсационных функциональных процессов при воздействии однонаправленных негативных факторов.

Например, некоторые негативные факторы могут понемногу увеличиваться в одном скоординированном направлении, что может приводить к большим выбросам значений отдельных показателей, находящихся в функциональном взаимоотношении с данными факторами. Функциональное состояние --- это система функций от значений показателей объекта, т.~е. как должны изменяться показатели объекта при изменении других, например, возрастать или убывать.

Можно сделать вывод, что в данном численном эксперименте в множестве объектов лишь 35~\% объектов имели нарушенное функциональное состояние или имели какую-либо ошибку в измерении показателей. Поэтому в диагностике объектов нельзя использовать один показатель, в данном случае это был показатель повышенного артериального давления. Такое повышенное артериальное давление может быть нормальным значением в виду скоординированного небольшого воздействия нескольких негативных факторов, вызывающих сильное отклонение от нормы данного показателя. Данные объекты при исключении вредных факторов должны показать улучшение значения отдельного диагностического показателя. Такая система в последствии будет продиагностирована как нормальная, поскольку изначально не имела нарушенного функционального взаимоотношения показателей. Её отдельные показатели придут в интервалы нормальных значений, если негативные факторы выйдут из скоординированного воздействия или сами потеряют свой негативный статус. Подобные функциональные системы или организмы и так были в норме или в индивидуальной норме. Они продолжают жить в рамках своих нормальных функциональных взаимоотношений. Помещённые в нормальные условия такие объекты должны продемонстрировать нормальные значения отдельных показателей. Поэтому можно рекомендовать нормальные условия существования для систем, и в случае обнаружения негативных факторов нивелировать их скоординированное негативное воздействие. Опасным представляется нормализация значений отдельных показателей без нормализации негативных факторов, поскольку в такой системе могут в дальнейшем проявиться различные нарушения функционального состояния, что в свою очередь может вывести всю систему из нормального функционирования, и система может начать распадаться на подсистемы, в которых ещё выполняется нормальное функциональное взаимоотношение показателей. В то же время не зависимые друг от друга подсистемы могут быть организованы вместе для выполнения определённых действий, для поддержания функционирования всего организма. Такого рода системы работают под действием внешней организующей силы либо существуют из-за работы подсистем. Чтобы снять нагрузку с организующей силы в системах, это перекладывается на функциональное взаимоотношение подсистем. В контексте медицины это означает, что в случае плохого функционального состояния необходимо поддержание всего организма и отдельных его функций с помощью постоянного лечения. В случае хорошего функционального состояния можно рекомендовать лечение по одновременному воздействию на группы показателей, соответствующих факторам заболевания. Устранить негативный статус факторов заболевания. Нарушить скоординированное воздействие таких факторов. Возможно, достаточно устранить всего один фактор риска.

\section{Заключение}

На базе метода штрафных функций и минимизации невязок уравнений факторной модели был разработан алгоритм восстановления пробелов данных. С помощью численного эксперимента была подтверждена работоспособность алгоритма.

\begin{thebibliography}{99}
\bibitem{svshovin}
Шовин В.А. Нелинейные структурные уравнения и квадратичный факторный анализ // Математические структуры и моделирование. 2018. №~2(46). С.~51--61.

\bibitem{sviberla}
Иберла К. Факторный анализ / Пер. с нем. В.М.~Ивановой; Предисл. А.М.~Дуброва.  М.~: Статистика, 1980.

\bibitem{svharman}
Харман Г. Современный факторный анализ / Пер. с англ. В.Я.~Лумельского; Научное редактирование и вступительная статья Э.М.~Бравермана. М.~: Статистика, 1972.

\bibitem{svbandi}
Банди Б. Методы оптимизации. Вводный курс. М.~: Радио и связь,  1988. 128~с.

\bibitem{svkokuev}
Кокуев А.Г. Оптимальное управление. Поиск экстремумов многомерных функций. Астрахань~: АГТУ, 2011. 34~с.

\end{thebibliography}

\clearpage\maketitleEng  %  Команда завершения статьи
{\protect\footnotesize \selectlanguage{english}\begin{thebibliography}{99}
\bibitem{svshovin}
Shovin V.A. Nelineinye strukturnye uravneniya i kvadratichnyi faktornyi analiz. Matematicheskie struktury i modelirovanie, 2018, no.~2(46), pp.~51--61.
 (in Russian)
\bibitem{sviberla}
Iberla K. Faktornyi analiz. Per. s nem. V.M. Ivanovoi, Predisl. A.M. Dubrova, Moscow, Statistika Publ., 1980.
 (in Russian)
\bibitem{svharman}
Kharman G. Sovremennyi faktornyi analiz. Per. s angl. V.Ya. Lumel'skogo, Nauchnoe redaktirovanie i vstupitel'naya stat'ya E.M. Bravermana, Moscow, Statistika Publ., 1972.
 (in Russian)
\bibitem{svbandi}
Bandi B. Metody optimizatsii. Vvodnyi kurs. Moscow, Radio i Svyaz' Publ., 1988, 128~p. (in Russian)
\bibitem{svkokuev}
Kokuev A.G. Optimal'noe upravlenie. Poisk ekstremumov mnogomernykh funktsii. Astrakhan', AGTU Publ., 2011, 34~p.
(in Russian) 
\end{thebibliography}
}

\endarticle